
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Node.js - klaw &#8212; Mathematics</title>
    
  <link href="../../../../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
    <script src="../../../../../_static/jquery.js"></script>
    <script src="../../../../../_static/underscore.js"></script>
    <script src="../../../../../_static/doctools.js"></script>
    <script src="../../../../../_static/togglebutton.js"></script>
    <script src="../../../../../_static/clipboard.min.js"></script>
    <script src="../../../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../../../index.html">
      
      <img src="../../../../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Mathematics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../README.html">
   Mathematics
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Foundations
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../Sets.html">
   Sets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../NumberTheory.html">
   Number Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../AlgorithmicNumberTheory.html">
   Algorithmic Number Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../ModularArithmetic.html">
   Modular Arithmetic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../Polynomials.html">
   Polynomials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../Structures.html">
   Structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../Groups.html">
   Groups
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../Fields.html">
   Fields
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../mathematical_foundations.html">
   Imports
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Modeling
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../RandomWalks.html">
   Random Walks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../DigitalSignalProcessing.html">
   Digital Signal Processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../DifferentialEquations.html">
   Differential Equations
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Blockchain
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../PythonBlockchain.html">
   Python Blockchain
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../../../_sources/nbs/z-repo_Solidity/Faucet/node_modules/klaw/README.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/davefriedman01/Resources"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/davefriedman01/Resources/issues/new?title=Issue%20on%20page%20%2Fnbs/z-repo_Solidity/Faucet/node_modules/klaw/README.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#install">
   Install
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#name">
   Name
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usage">
   Usage
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#klaw-directory-options">
     klaw(directory, [options])
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#error-handling">
     Error Handling
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#aggregation-filtering-executing-actions-through-streams">
     Aggregation / Filtering / Executing Actions (Through Streams)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#searching-strategy">
     Searching Strategy
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#license">
   License
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="node-js-klaw">
<h1>Node.js - klaw<a class="headerlink" href="#node-js-klaw" title="Permalink to this headline">¶</a></h1>
<p>A Node.js file system walker extracted from <a class="reference external" href="https://github.com/jprichardson/node-fs-extra">fs-extra</a>.</p>
<p><a class="reference external" href="https://www.npmjs.org/package/klaw"><img alt="npm Package" src="https://img.shields.io/npm/v/klaw.svg?style=flat-square" /></a>
<a class="reference external" href="http://travis-ci.org/jprichardson/node-klaw"><img alt="build status" src="https://api.travis-ci.org/jprichardson/node-klaw.svg" /></a>
<a class="reference external" href="https://ci.appveyor.com/project/jprichardson/node-klaw/branch/master"><img alt="windows build status" src="https://ci.appveyor.com/api/projects/status/github/jprichardson/node-klaw?branch=master&amp;svg=true" /></a></p>
<!-- [![js-standard-style](https://cdn.rawgit.com/feross/standard/master/badge.svg)](https://github.com/feross/standard) -->
<p><a href="http://standardjs.com"><img src="https://cdn.rawgit.com/feross/standard/master/sticker.svg" alt="Standard" width="100"></a></p>
<div class="section" id="install">
<h2>Install<a class="headerlink" href="#install" title="Permalink to this headline">¶</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>npm i --save klaw
</pre></div>
</div>
</div>
<div class="section" id="name">
<h2>Name<a class="headerlink" href="#name" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">klaw</span></code> is <code class="docutils literal notranslate"><span class="pre">walk</span></code> backwards :p</p>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="section" id="klaw-directory-options">
<h3>klaw(directory, [options])<a class="headerlink" href="#klaw-directory-options" title="Permalink to this headline">¶</a></h3>
<p>Returns a <a class="reference external" href="https://nodejs.org/api/stream.html#stream_class_stream_readable">Readable stream</a> that iterates
through every file and directory starting with <code class="docutils literal notranslate"><span class="pre">dir</span></code> as the root. Every <code class="docutils literal notranslate"><span class="pre">read()</span></code> or <code class="docutils literal notranslate"><span class="pre">data</span></code> event
returns an object with two properties: <code class="docutils literal notranslate"><span class="pre">path</span></code> and <code class="docutils literal notranslate"><span class="pre">stats</span></code>. <code class="docutils literal notranslate"><span class="pre">path</span></code> is the full path of the file and
<code class="docutils literal notranslate"><span class="pre">stats</span></code> is an instance of <a class="reference external" href="https://nodejs.org/api/fs.html#fs_class_fs_stats">fs.Stats</a>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">directory</span></code>: The directory to recursively walk. Type <code class="docutils literal notranslate"><span class="pre">string</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">options</span></code>: <a class="reference external" href="https://nodejs.org/api/stream.html#stream_new_stream_readable_options">Readable stream options</a> and
the following:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">queueMethod</span></code> (<code class="docutils literal notranslate"><span class="pre">string</span></code>, default: <code class="docutils literal notranslate"><span class="pre">'shift'</span></code>): Either <code class="docutils literal notranslate"><span class="pre">'shift'</span></code> or <code class="docutils literal notranslate"><span class="pre">'pop'</span></code>. On <code class="docutils literal notranslate"><span class="pre">readdir()</span></code> array, call either <code class="docutils literal notranslate"><span class="pre">shift()</span></code> or <code class="docutils literal notranslate"><span class="pre">pop()</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pathSorter</span></code> (<code class="docutils literal notranslate"><span class="pre">function</span></code>, default: <code class="docutils literal notranslate"><span class="pre">undefined</span></code>): Sorting <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort">function for Arrays</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fs</span></code> (<code class="docutils literal notranslate"><span class="pre">object</span></code>, default: <code class="docutils literal notranslate"><span class="pre">require('fs')</span></code>): Use this to hook into the <code class="docutils literal notranslate"><span class="pre">fs</span></code> methods or to use <a class="reference external" href="https://github.com/tschaub/mock-fs"><code class="docutils literal notranslate"><span class="pre">mock-fs</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">filter</span></code> (<code class="docutils literal notranslate"><span class="pre">function</span></code>, default: <code class="docutils literal notranslate"><span class="pre">undefined</span></code>): Filtering <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter">function for Arrays</a></p></li>
</ul>
</li>
</ul>
<p><strong>Streams 1 (push) example:</strong></p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">klaw</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;klaw&#39;</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">items</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">// files, directories, symlinks, etc</span>
<span class="nx">klaw</span><span class="p">(</span><span class="s1">&#39;/some/dir&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">items</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">path</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">items</span><span class="p">)</span> <span class="c1">// =&gt; [ ... array of files]</span>
  <span class="p">})</span>
</pre></div>
</div>
<p><strong>Streams 2 &amp; 3 (pull) example:</strong></p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">klaw</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;klaw&#39;</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">items</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">// files, directories, symlinks, etc</span>
<span class="nx">klaw</span><span class="p">(</span><span class="s1">&#39;/some/dir&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;readable&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">item</span>
    <span class="k">while</span> <span class="p">((</span><span class="nx">item</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">read</span><span class="p">()))</span> <span class="p">{</span>
      <span class="nx">items</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">path</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">items</span><span class="p">)</span> <span class="c1">// =&gt; [ ... array of files]</span>
  <span class="p">})</span>
</pre></div>
</div>
<p>If you’re not sure of the differences on Node.js streams 1, 2, 3 then I’d
recommend this resource as a good starting point: <a class="reference external" href="https://strongloop.com/strongblog/whats-new-io-js-beta-streams3/">https://strongloop.com/strongblog/whats-new-io-js-beta-streams3/</a>.</p>
</div>
<div class="section" id="error-handling">
<h3>Error Handling<a class="headerlink" href="#error-handling" title="Permalink to this headline">¶</a></h3>
<p>Listen for the <code class="docutils literal notranslate"><span class="pre">error</span></code> event.</p>
<p>Example:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">klaw</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;klaw&#39;</span><span class="p">)</span>
<span class="nx">klaw</span><span class="p">(</span><span class="s1">&#39;/some/dir&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;readable&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">item</span>
    <span class="k">while</span> <span class="p">((</span><span class="nx">item</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">read</span><span class="p">()))</span> <span class="p">{</span>
      <span class="c1">// do something with the file</span>
    <span class="p">}</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">)</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">path</span><span class="p">)</span> <span class="c1">// the file the error occurred on</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">items</span><span class="p">)</span> <span class="c1">// =&gt; [ ... array of files]</span>
  <span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="aggregation-filtering-executing-actions-through-streams">
<h3>Aggregation / Filtering / Executing Actions (Through Streams)<a class="headerlink" href="#aggregation-filtering-executing-actions-through-streams" title="Permalink to this headline">¶</a></h3>
<p>On many occasions you may want to filter files based upon size, extension, etc.
Or you may want to aggregate stats on certain file types. Or maybe you want to
perform an action on certain file types.</p>
<p>You should use the module <a class="reference external" href="https://www.npmjs.com/package/through2"><code class="docutils literal notranslate"><span class="pre">through2</span></code></a> to easily
accomplish this.</p>
<p>Install <code class="docutils literal notranslate"><span class="pre">through2</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>npm i --save through2
</pre></div>
</div>
<p><strong>Example (skipping directories):</strong></p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">klaw</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;klaw&#39;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">through2</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;through2&#39;</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">excludeDirFilter</span> <span class="o">=</span> <span class="nx">through2</span><span class="p">.</span><span class="nx">obj</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">enc</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">item</span><span class="p">.</span><span class="nx">stats</span><span class="p">.</span><span class="nx">isDirectory</span><span class="p">())</span> <span class="k">this</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span>
  <span class="nx">next</span><span class="p">()</span>
<span class="p">})</span>

<span class="kd">var</span> <span class="nx">items</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">// files, directories, symlinks, etc</span>
<span class="nx">klaw</span><span class="p">(</span><span class="s1">&#39;/some/dir&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">excludeDirFilter</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">items</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">path</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">items</span><span class="p">)</span> <span class="c1">// =&gt; [ ... array of files without directories]</span>
  <span class="p">})</span>
</pre></div>
</div>
<p><strong>Example (ignore hidden directories):</strong></p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">klaw</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;klaw&#39;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">filterFunc</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">basename</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">basename</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">basename</span> <span class="o">===</span> <span class="s1">&#39;.&#39;</span> <span class="o">||</span> <span class="nx">basename</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">!==</span> <span class="s1">&#39;.&#39;</span>
<span class="p">}</span>

<span class="nx">klaw</span><span class="p">(</span><span class="s1">&#39;/some/dir&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">filter</span> <span class="o">:</span> <span class="nx">filterFunc</span>  <span class="p">})</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">){</span>
    <span class="c1">// only items of none hidden folders will reach here</span>
  <span class="p">})</span>
    
</pre></div>
</div>
<p><strong>Example (totaling size of PNG files):</strong></p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">klaw</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;klaw&#39;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">through2</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;through2&#39;</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">totalPngsInBytes</span> <span class="o">=</span> <span class="mf">0</span>
<span class="kd">var</span> <span class="nx">aggregatePngSize</span> <span class="o">=</span> <span class="nx">through2</span><span class="p">.</span><span class="nx">obj</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">enc</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">extname</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">path</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;.png&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">totalPngsInBytes</span> <span class="o">+=</span> <span class="nx">item</span><span class="p">.</span><span class="nx">stats</span><span class="p">.</span><span class="nx">size</span>
  <span class="p">}</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span>
  <span class="nx">next</span><span class="p">()</span>
<span class="p">})</span>

<span class="nx">klaw</span><span class="p">(</span><span class="s1">&#39;/some/dir&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">aggregatePngSize</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">items</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">path</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">totalPngsInBytes</span><span class="p">)</span> <span class="c1">// =&gt; total of all pngs (bytes)</span>
  <span class="p">})</span>
</pre></div>
</div>
<p><strong>Example (deleting all .tmp files):</strong></p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">klaw</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;klaw&#39;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">through2</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;through2&#39;</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">deleteAction</span> <span class="o">=</span> <span class="nx">through2</span><span class="p">.</span><span class="nx">obj</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">enc</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">extname</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">path</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;.tmp&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">deleted</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="nx">fs</span><span class="p">.</span><span class="nx">unklink</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">path</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">deleted</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="nx">next</span><span class="p">()</span>
  <span class="p">}</span>  
<span class="p">})</span>

<span class="kd">var</span> <span class="nx">deletedFiles</span> <span class="o">=</span> <span class="p">[]</span>
<span class="nx">klaw</span><span class="p">(</span><span class="s1">&#39;/some/dir&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">deleteAction</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">item</span><span class="p">.</span><span class="nx">deleted</span><span class="p">)</span> <span class="k">return</span>
    <span class="nx">deletedFiles</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">path</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">deletedFiles</span><span class="p">)</span> <span class="c1">// =&gt; all deleted files</span>
  <span class="p">})</span>
</pre></div>
</div>
<p>You can even chain a bunch of these filters and aggregators together. By using
multiple pipes.</p>
<p><strong>Example (using multiple filters / aggregators):</strong></p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">klaw</span><span class="p">(</span><span class="s1">&#39;/some/dir&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">filterCertainFiles</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">deleteSomeOtherFiles</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;all done!&#39;</span><span class="p">)</span>
  <span class="p">})</span>
</pre></div>
</div>
<p><strong>Example passing (piping) through errors:</strong></p>
<p>Node.js does not <code class="docutils literal notranslate"><span class="pre">pipe()</span></code> errors. This means that the error on one stream, like
<code class="docutils literal notranslate"><span class="pre">klaw</span></code> will not pipe through to the next. If you want to do this, do the following:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">klaw</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;klaw&#39;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">through2</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;through2&#39;</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">excludeDirFilter</span> <span class="o">=</span> <span class="nx">through2</span><span class="p">.</span><span class="nx">obj</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">enc</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">item</span><span class="p">.</span><span class="nx">stats</span><span class="p">.</span><span class="nx">isDirectory</span><span class="p">())</span> <span class="k">this</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span>
  <span class="nx">next</span><span class="p">()</span>
<span class="p">})</span>

<span class="kd">var</span> <span class="nx">items</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">// files, directories, symlinks, etc</span>
<span class="nx">klaw</span><span class="p">(</span><span class="s1">&#39;/some/dir&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span> <span class="nx">excludeDirFilter</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span> <span class="p">})</span> <span class="c1">// forward the error on</span>
  <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">excludeDirFilter</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">items</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">path</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">items</span><span class="p">)</span> <span class="c1">// =&gt; [ ... array of files without directories]</span>
  <span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="searching-strategy">
<h3>Searching Strategy<a class="headerlink" href="#searching-strategy" title="Permalink to this headline">¶</a></h3>
<p>Pass in options for <code class="docutils literal notranslate"><span class="pre">queueMethod</span></code> and <code class="docutils literal notranslate"><span class="pre">pathSorter</span></code> to affect how the file system
is recursively iterated. See the code for more details, it’s less than 50 lines :)</p>
</div>
</div>
<div class="section" id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h2>
<p>MIT</p>
<p>Copyright (c) 2015 <a class="reference external" href="https://github.com/jprichardson">JP Richardson</a></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./nbs/z-repo_Solidity/Faucet/node_modules/klaw"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Dave Friedman<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>