
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Deprecated! &#8212; Mathematics</title>
    
  <link href="../../../../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
    <script src="../../../../../_static/jquery.js"></script>
    <script src="../../../../../_static/underscore.js"></script>
    <script src="../../../../../_static/doctools.js"></script>
    <script src="../../../../../_static/togglebutton.js"></script>
    <script src="../../../../../_static/clipboard.min.js"></script>
    <script src="../../../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../../../index.html">
      
      <img src="../../../../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Mathematics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../../README.html">
   Mathematics
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Foundations
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../Sets.html">
   Sets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../NumberTheory.html">
   Number Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../AlgorithmicNumberTheory.html">
   Algorithmic Number Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../ModularArithmetic.html">
   Modular Arithmetic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../Polynomials.html">
   Polynomials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../Structures.html">
   Structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../Groups.html">
   Groups
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../Fields.html">
   Fields
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../mathematical_foundations.html">
   Imports
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Modeling
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../RandomWalks.html">
   Random Walks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../DigitalSignalProcessing.html">
   Digital Signal Processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../DifferentialEquations.html">
   Differential Equations
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Blockchain
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../../PythonBlockchain.html">
   Python Blockchain
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../../../_sources/nbs/z-repo_Solidity/Faucet/node_modules/request/README.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/davefriedman01/Resources"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/davefriedman01/Resources/issues/new?title=Issue%20on%20page%20%2Fnbs/z-repo_Solidity/Faucet/node_modules/request/README.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Deprecated!
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#request-simplified-http-client">
   Request - Simplified HTTP client
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#super-simple-to-use">
     Super simple to use
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#table-of-contents">
     Table of contents
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#streaming">
     Streaming
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#promises-async-await">
     Promises &amp; Async/Await
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#forms">
     Forms
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#application-x-www-form-urlencoded-url-encoded-forms">
       application/x-www-form-urlencoded (URL-Encoded Forms)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#multipart-form-data-multipart-form-uploads">
       multipart/form-data (Multipart Form Uploads)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#multipart-related">
       multipart/related
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#http-authentication">
     HTTP Authentication
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#custom-http-headers">
     Custom HTTP Headers
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#oauth-signing">
     OAuth Signing
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#proxies">
     Proxies
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#controlling-proxy-behaviour-using-environment-variables">
       Controlling proxy behaviour using environment variables
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unix-domain-sockets">
     UNIX Domain Sockets
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tls-ssl-protocol">
     TLS/SSL Protocol
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#using-options-agentoptions">
       Using
       <code class="docutils literal notranslate">
        <span class="pre">
         options.agentOptions
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#support-for-har-1-2">
     Support for HAR 1.2
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#request-options-callback">
     request(options, callback)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convenience-methods">
     Convenience methods
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#request-defaults-options">
       request.defaults(options)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#request-method">
       request.METHOD()
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#request-cookie">
       request.cookie()
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#request-jar">
       request.jar()
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#response-caseless-get-header-name">
       response.caseless.get(‘header-name’)
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#debugging">
     Debugging
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#timeouts">
     Timeouts
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#examples">
     Examples:
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="deprecated">
<h1>Deprecated!<a class="headerlink" href="#deprecated" title="Permalink to this headline">¶</a></h1>
<p>As of Feb 11th 2020, request is fully deprecated. No new changes are expected land. In fact, none have landed for some time.</p>
<p>For more information about why request is deprecated and possible alternatives refer to
<a class="reference external" href="https://github.com/request/request/issues/3142">this issue</a>.</p>
</div>
<div class="section" id="request-simplified-http-client">
<h1>Request - Simplified HTTP client<a class="headerlink" href="#request-simplified-http-client" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://nodei.co/npm/request/"><img alt="npm package" src="https://nodei.co/npm/request.png?downloads=true&amp;downloadRank=true&amp;stars=true" /></a></p>
<p><a class="reference external" href="https://travis-ci.org/request/request"><img alt="Build status" src="https://img.shields.io/travis/request/request/master.svg?style=flat-square" /></a>
<a class="reference external" href="https://codecov.io/github/request/request?branch=master"><img alt="Coverage" src="https://img.shields.io/codecov/c/github/request/request.svg?style=flat-square" /></a>
<a class="reference external" href="https://coveralls.io/r/request/request"><img alt="Coverage" src="https://img.shields.io/coveralls/request/request.svg?style=flat-square" /></a>
<a class="reference external" href="https://david-dm.org/request/request"><img alt="Dependency Status" src="https://img.shields.io/david/request/request.svg?style=flat-square" /></a>
<a class="reference external" href="https://snyk.io/test/npm/request"><img alt="Known Vulnerabilities" src="https://snyk.io/test/npm/request/badge.svg?style=flat-square" /></a>
<a class="reference external" href="https://gitter.im/request/request?utm_source=badge"><img alt="Gitter" src="https://img.shields.io/badge/gitter-join_chat-blue.svg?style=flat-square" /></a></p>
<div class="section" id="super-simple-to-use">
<h2>Super simple to use<a class="headerlink" href="#super-simple-to-use" title="Permalink to this headline">¶</a></h2>
<p>Request is designed to be the simplest way possible to make http calls. It supports HTTPS and follows redirects by default.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">);</span>
<span class="nx">request</span><span class="p">(</span><span class="s1">&#39;http://www.google.com&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;error:&#39;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span> <span class="c1">// Print the error if one occurred</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;statusCode:&#39;</span><span class="p">,</span> <span class="nx">response</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">);</span> <span class="c1">// Print the response status code if a response was received</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;body:&#39;</span><span class="p">,</span> <span class="nx">body</span><span class="p">);</span> <span class="c1">// Print the HTML for the Google homepage.</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="table-of-contents">
<h2>Table of contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="#streaming">Streaming</a></p></li>
<li><p><a class="reference external" href="#promises--asyncawait">Promises &amp; Async/Await</a></p></li>
<li><p><a class="reference external" href="#forms">Forms</a></p></li>
<li><p><a class="reference external" href="#http-authentication">HTTP Authentication</a></p></li>
<li><p><a class="reference external" href="#custom-http-headers">Custom HTTP Headers</a></p></li>
<li><p><a class="reference external" href="#oauth-signing">OAuth Signing</a></p></li>
<li><p><a class="reference external" href="#proxies">Proxies</a></p></li>
<li><p><a class="reference external" href="#unix-domain-sockets">Unix Domain Sockets</a></p></li>
<li><p><a class="reference external" href="#tlsssl-protocol">TLS/SSL Protocol</a></p></li>
<li><p><a class="reference external" href="#support-for-har-12">Support for HAR 1.2</a></p></li>
<li><p><a class="reference external" href="#requestoptions-callback"><strong>All Available Options</strong></a></p></li>
</ul>
<p>Request also offers <a class="reference external" href="#convenience-methods">convenience methods</a> like
<code class="docutils literal notranslate"><span class="pre">request.defaults</span></code> and <code class="docutils literal notranslate"><span class="pre">request.post</span></code>, and there are
lots of <a class="reference external" href="#examples">usage examples</a> and several
<a class="reference external" href="#debugging">debugging techniques</a>.</p>
</div>
<hr class="docutils" />
<div class="section" id="streaming">
<h2>Streaming<a class="headerlink" href="#streaming" title="Permalink to this headline">¶</a></h2>
<p>You can stream any response to a file stream.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">request</span><span class="p">(</span><span class="s1">&#39;http://google.com/doodle.png&#39;</span><span class="p">).</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">createWriteStream</span><span class="p">(</span><span class="s1">&#39;doodle.png&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>You can also stream a file to a PUT or POST request. This method will also check the file extension against a mapping of file extensions to content-types (in this case <code class="docutils literal notranslate"><span class="pre">application/json</span></code>) and use the proper <code class="docutils literal notranslate"><span class="pre">content-type</span></code> in the PUT request (if the headers don’t already provide one).</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">fs</span><span class="p">.</span><span class="nx">createReadStream</span><span class="p">(</span><span class="s1">&#39;file.json&#39;</span><span class="p">).</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="s1">&#39;http://mysite.com/obj.json&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>Request can also <code class="docutils literal notranslate"><span class="pre">pipe</span></code> to itself. When doing so, <code class="docutils literal notranslate"><span class="pre">content-type</span></code> and <code class="docutils literal notranslate"><span class="pre">content-length</span></code> are preserved in the PUT headers.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">request</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;http://google.com/img.png&#39;</span><span class="p">).</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="s1">&#39;http://mysite.com/img.png&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>Request emits a “response” event when a response is received. The <code class="docutils literal notranslate"><span class="pre">response</span></code> argument will be an instance of <a class="reference external" href="https://nodejs.org/api/http.html#http_class_http_incomingmessage">http.IncomingMessage</a>.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">request</span>
  <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;http://google.com/img.png&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;response&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">)</span> <span class="c1">// 200</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="s1">&#39;content-type&#39;</span><span class="p">])</span> <span class="c1">// &#39;image/png&#39;</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="s1">&#39;http://mysite.com/img.png&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>To easily handle errors when streaming requests, listen to the <code class="docutils literal notranslate"><span class="pre">error</span></code> event before piping:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">request</span>
  <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;http://mysite.com/doodle.png&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">createWriteStream</span><span class="p">(</span><span class="s1">&#39;doodle.png&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>Now let’s get fancy.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">http</span><span class="p">.</span><span class="nx">createServer</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">resp</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">url</span> <span class="o">===</span> <span class="s1">&#39;/doodle.png&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">method</span> <span class="o">===</span> <span class="s1">&#39;PUT&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">req</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="s1">&#39;http://mysite.com/doodle.png&#39;</span><span class="p">))</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">method</span> <span class="o">===</span> <span class="s1">&#39;GET&#39;</span> <span class="o">||</span> <span class="nx">req</span><span class="p">.</span><span class="nx">method</span> <span class="o">===</span> <span class="s1">&#39;HEAD&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">request</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;http://mysite.com/doodle.png&#39;</span><span class="p">).</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">resp</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<p>You can also <code class="docutils literal notranslate"><span class="pre">pipe()</span></code> from <code class="docutils literal notranslate"><span class="pre">http.ServerRequest</span></code> instances, as well as to <code class="docutils literal notranslate"><span class="pre">http.ServerResponse</span></code> instances. The HTTP method, headers, and entity-body data will be sent. Which means that, if you don’t really care about security, you can do:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">http</span><span class="p">.</span><span class="nx">createServer</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">resp</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">url</span> <span class="o">===</span> <span class="s1">&#39;/doodle.png&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">request</span><span class="p">(</span><span class="s1">&#39;http://mysite.com/doodle.png&#39;</span><span class="p">)</span>
    <span class="nx">req</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span>
    <span class="nx">x</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">resp</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<p>And since <code class="docutils literal notranslate"><span class="pre">pipe()</span></code> returns the destination stream in ≥ Node 0.5.x you can do one line proxying. :)</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">req</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">request</span><span class="p">(</span><span class="s1">&#39;http://mysite.com/doodle.png&#39;</span><span class="p">)).</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">resp</span><span class="p">)</span>
</pre></div>
</div>
<p>Also, none of this new functionality conflicts with requests previous features, it just expands them.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span> <span class="nx">r</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">defaults</span><span class="p">({</span><span class="s1">&#39;proxy&#39;</span><span class="o">:</span><span class="s1">&#39;http://localproxy.com&#39;</span><span class="p">})</span>

<span class="nx">http</span><span class="p">.</span><span class="nx">createServer</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">resp</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">url</span> <span class="o">===</span> <span class="s1">&#39;/doodle.png&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">r</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;http://google.com/doodle.png&#39;</span><span class="p">).</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">resp</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<p>You can still use intermediate proxies, the requests will still follow HTTP forwards, etc.</p>
<p><a class="reference external" href="#table-of-contents">back to top</a></p>
</div>
<hr class="docutils" />
<div class="section" id="promises-async-await">
<h2>Promises &amp; Async/Await<a class="headerlink" href="#promises-async-await" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">request</span></code> supports both streaming and callback interfaces natively. If you’d like <code class="docutils literal notranslate"><span class="pre">request</span></code> to return a Promise instead, you can use an alternative interface wrapper for <code class="docutils literal notranslate"><span class="pre">request</span></code>. These wrappers can be useful if you prefer to work with Promises, or if you’d like to use <code class="docutils literal notranslate"><span class="pre">async</span></code>/<code class="docutils literal notranslate"><span class="pre">await</span></code> in ES2017.</p>
<p>Several alternative interfaces are provided by the request team, including:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/request/request-promise"><code class="docutils literal notranslate"><span class="pre">request-promise</span></code></a> (uses <a class="reference external" href="https://github.com/petkaantonov/bluebird">Bluebird</a> Promises)</p></li>
<li><p><a class="reference external" href="https://github.com/request/request-promise-native"><code class="docutils literal notranslate"><span class="pre">request-promise-native</span></code></a> (uses native Promises)</p></li>
<li><p><a class="reference external" href="https://github.com/request/request-promise-any"><code class="docutils literal notranslate"><span class="pre">request-promise-any</span></code></a> (uses <a class="reference external" href="https://www.npmjs.com/package/any-promise">any-promise</a> Promises)</p></li>
</ul>
<p>Also, <a class="reference external" href="https://nodejs.org/api/util.html#util_util_promisify_original"><code class="docutils literal notranslate"><span class="pre">util.promisify</span></code></a>, which is available from Node.js v8.0 can be used to convert a regular function that takes a callback to return a promise instead.</p>
<p><a class="reference external" href="#table-of-contents">back to top</a></p>
</div>
<hr class="docutils" />
<div class="section" id="forms">
<h2>Forms<a class="headerlink" href="#forms" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">request</span></code> supports <code class="docutils literal notranslate"><span class="pre">application/x-www-form-urlencoded</span></code> and <code class="docutils literal notranslate"><span class="pre">multipart/form-data</span></code> form uploads. For <code class="docutils literal notranslate"><span class="pre">multipart/related</span></code> refer to the <code class="docutils literal notranslate"><span class="pre">multipart</span></code> API.</p>
<div class="section" id="application-x-www-form-urlencoded-url-encoded-forms">
<h3>application/x-www-form-urlencoded (URL-Encoded Forms)<a class="headerlink" href="#application-x-www-form-urlencoded-url-encoded-forms" title="Permalink to this headline">¶</a></h3>
<p>URL-encoded forms are simple.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;http://service.com/upload&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">form</span><span class="o">:</span><span class="p">{</span><span class="nx">key</span><span class="o">:</span><span class="s1">&#39;value&#39;</span><span class="p">}})</span>
<span class="c1">// or</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;http://service.com/upload&#39;</span><span class="p">).</span><span class="nx">form</span><span class="p">({</span><span class="nx">key</span><span class="o">:</span><span class="s1">&#39;value&#39;</span><span class="p">})</span>
<span class="c1">// or</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span><span class="nx">url</span><span class="o">:</span><span class="s1">&#39;http://service.com/upload&#39;</span><span class="p">,</span> <span class="nx">form</span><span class="o">:</span> <span class="p">{</span><span class="nx">key</span><span class="o">:</span><span class="s1">&#39;value&#39;</span><span class="p">}},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="nx">httpResponse</span><span class="p">,</span><span class="nx">body</span><span class="p">){</span> <span class="cm">/* ... */</span> <span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="multipart-form-data-multipart-form-uploads">
<h3>multipart/form-data (Multipart Form Uploads)<a class="headerlink" href="#multipart-form-data-multipart-form-uploads" title="Permalink to this headline">¶</a></h3>
<p>For <code class="docutils literal notranslate"><span class="pre">multipart/form-data</span></code> we use the <a class="reference external" href="https://github.com/form-data/form-data">form-data</a> library by <a class="reference external" href="https://github.com/felixge">&#64;felixge</a>. For the most cases, you can pass your upload form data via the <code class="docutils literal notranslate"><span class="pre">formData</span></code> option.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span> <span class="nx">formData</span> <span class="o">=</span> <span class="p">{</span>
  <span class="c1">// Pass a simple key-value pair</span>
  <span class="nx">my_field</span><span class="o">:</span> <span class="s1">&#39;my_value&#39;</span><span class="p">,</span>
  <span class="c1">// Pass data via Buffers</span>
  <span class="nx">my_buffer</span><span class="o">:</span> <span class="nx">Buffer</span><span class="p">.</span><span class="k">from</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">3</span><span class="p">]),</span>
  <span class="c1">// Pass data via Streams</span>
  <span class="nx">my_file</span><span class="o">:</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">createReadStream</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">&#39;/unicycle.jpg&#39;</span><span class="p">),</span>
  <span class="c1">// Pass multiple values /w an Array</span>
  <span class="nx">attachments</span><span class="o">:</span> <span class="p">[</span>
    <span class="nx">fs</span><span class="p">.</span><span class="nx">createReadStream</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">&#39;/attachment1.jpg&#39;</span><span class="p">),</span>
    <span class="nx">fs</span><span class="p">.</span><span class="nx">createReadStream</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">&#39;/attachment2.jpg&#39;</span><span class="p">)</span>
  <span class="p">],</span>
  <span class="c1">// Pass optional meta-data with an &#39;options&#39; object with style: {value: DATA, options: OPTIONS}</span>
  <span class="c1">// Use case: for some types of streams, you&#39;ll need to provide &quot;file&quot;-related information manually.</span>
  <span class="c1">// See the `form-data` README for more information about options: https://github.com/form-data/form-data</span>
  <span class="nx">custom_file</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">value</span><span class="o">:</span>  <span class="nx">fs</span><span class="p">.</span><span class="nx">createReadStream</span><span class="p">(</span><span class="s1">&#39;/dev/urandom&#39;</span><span class="p">),</span>
    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">filename</span><span class="o">:</span> <span class="s1">&#39;topsecret.jpg&#39;</span><span class="p">,</span>
      <span class="nx">contentType</span><span class="o">:</span> <span class="s1">&#39;image/jpeg&#39;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span><span class="nx">url</span><span class="o">:</span><span class="s1">&#39;http://service.com/upload&#39;</span><span class="p">,</span> <span class="nx">formData</span><span class="o">:</span> <span class="nx">formData</span><span class="p">},</span> <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;upload failed:&#39;</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Upload successful!  Server responded with:&#39;</span><span class="p">,</span> <span class="nx">body</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>For advanced cases, you can access the form-data object itself via <code class="docutils literal notranslate"><span class="pre">r.form()</span></code>. This can be modified until the request is fired on the next cycle of the event-loop. (Note that this calling <code class="docutils literal notranslate"><span class="pre">form()</span></code> will clear the currently set form data for that request.)</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// NOTE: Advanced use-case, for normal use see &#39;formData&#39; usage above</span>
<span class="kd">const</span> <span class="nx">r</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;http://service.com/upload&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{...})</span>
<span class="kd">const</span> <span class="nx">form</span> <span class="o">=</span> <span class="nx">r</span><span class="p">.</span><span class="nx">form</span><span class="p">();</span>
<span class="nx">form</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;my_field&#39;</span><span class="p">,</span> <span class="s1">&#39;my_value&#39;</span><span class="p">);</span>
<span class="nx">form</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;my_buffer&#39;</span><span class="p">,</span> <span class="nx">Buffer</span><span class="p">.</span><span class="k">from</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">3</span><span class="p">]));</span>
<span class="nx">form</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;custom_file&#39;</span><span class="p">,</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">createReadStream</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">&#39;/unicycle.jpg&#39;</span><span class="p">),</span> <span class="p">{</span><span class="nx">filename</span><span class="o">:</span> <span class="s1">&#39;unicycle.jpg&#39;</span><span class="p">});</span>
</pre></div>
</div>
<p>See the <a class="reference external" href="https://github.com/form-data/form-data">form-data README</a> for more information &amp; examples.</p>
</div>
<div class="section" id="multipart-related">
<h3>multipart/related<a class="headerlink" href="#multipart-related" title="Permalink to this headline">¶</a></h3>
<p>Some variations in different HTTP implementations require a newline/CRLF before, after, or both before and after the boundary of a <code class="docutils literal notranslate"><span class="pre">multipart/related</span></code> request (using the multipart option). This has been observed in the .NET WebAPI version 4.0. You can turn on a boundary preambleCRLF or postamble by passing them as <code class="docutils literal notranslate"><span class="pre">true</span></code> to your request options.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span>  <span class="nx">request</span><span class="p">({</span>
    <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;PUT&#39;</span><span class="p">,</span>
    <span class="nx">preambleCRLF</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">postambleCRLF</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">uri</span><span class="o">:</span> <span class="s1">&#39;http://service.com/upload&#39;</span><span class="p">,</span>
    <span class="nx">multipart</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s1">&#39;content-type&#39;</span><span class="o">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
        <span class="nx">body</span><span class="o">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span><span class="nx">foo</span><span class="o">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="nx">_attachments</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;message.txt&#39;</span><span class="o">:</span> <span class="p">{</span><span class="nx">follows</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">length</span><span class="o">:</span> <span class="mf">18</span><span class="p">,</span> <span class="s1">&#39;content_type&#39;</span><span class="o">:</span> <span class="s1">&#39;text/plain&#39;</span> <span class="p">}}})</span>
      <span class="p">},</span>
      <span class="p">{</span> <span class="nx">body</span><span class="o">:</span> <span class="s1">&#39;I am an attachment&#39;</span> <span class="p">},</span>
      <span class="p">{</span> <span class="nx">body</span><span class="o">:</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">createReadStream</span><span class="p">(</span><span class="s1">&#39;image.png&#39;</span><span class="p">)</span> <span class="p">}</span>
    <span class="p">],</span>
    <span class="c1">// alternatively pass an object containing additional options</span>
    <span class="nx">multipart</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">chunked</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="nx">data</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s1">&#39;content-type&#39;</span><span class="o">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
          <span class="nx">body</span><span class="o">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span><span class="nx">foo</span><span class="o">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="nx">_attachments</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;message.txt&#39;</span><span class="o">:</span> <span class="p">{</span><span class="nx">follows</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">length</span><span class="o">:</span> <span class="mf">18</span><span class="p">,</span> <span class="s1">&#39;content_type&#39;</span><span class="o">:</span> <span class="s1">&#39;text/plain&#39;</span> <span class="p">}}})</span>
        <span class="p">},</span>
        <span class="p">{</span> <span class="nx">body</span><span class="o">:</span> <span class="s1">&#39;I am an attachment&#39;</span> <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;upload failed:&#39;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Upload successful!  Server responded with:&#39;</span><span class="p">,</span> <span class="nx">body</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div>
</div>
<p><a class="reference external" href="#table-of-contents">back to top</a></p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="http-authentication">
<h2>HTTP Authentication<a class="headerlink" href="#http-authentication" title="Permalink to this headline">¶</a></h2>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">request</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;http://some.server.com/&#39;</span><span class="p">).</span><span class="nx">auth</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="c1">// or</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;http://some.server.com/&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="s1">&#39;auth&#39;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;user&#39;</span><span class="o">:</span> <span class="s1">&#39;username&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pass&#39;</span><span class="o">:</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sendImmediately&#39;</span><span class="o">:</span> <span class="kc">false</span>
  <span class="p">}</span>
<span class="p">});</span>
<span class="c1">// or</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;http://some.server.com/&#39;</span><span class="p">).</span><span class="nx">auth</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="s1">&#39;bearerToken&#39;</span><span class="p">);</span>
<span class="c1">// or</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;http://some.server.com/&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="s1">&#39;auth&#39;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;bearer&#39;</span><span class="o">:</span> <span class="s1">&#39;bearerToken&#39;</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p>If passed as an option, <code class="docutils literal notranslate"><span class="pre">auth</span></code> should be a hash containing values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> || <code class="docutils literal notranslate"><span class="pre">username</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pass</span></code> || <code class="docutils literal notranslate"><span class="pre">password</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sendImmediately</span></code> (optional)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bearer</span></code> (optional)</p></li>
</ul>
<p>The method form takes parameters
<code class="docutils literal notranslate"><span class="pre">auth(username,</span> <span class="pre">password,</span> <span class="pre">sendImmediately,</span> <span class="pre">bearer)</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">sendImmediately</span></code> defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>, which causes a basic or bearer
authentication header to be sent. If <code class="docutils literal notranslate"><span class="pre">sendImmediately</span></code> is <code class="docutils literal notranslate"><span class="pre">false</span></code>, then
<code class="docutils literal notranslate"><span class="pre">request</span></code> will retry with a proper authentication header after receiving a
<code class="docutils literal notranslate"><span class="pre">401</span></code> response from the server (which must contain a <code class="docutils literal notranslate"><span class="pre">WWW-Authenticate</span></code> header
indicating the required authentication method).</p>
<p>Note that you can also specify basic authentication using the URL itself, as
detailed in <a class="reference external" href="http://www.ietf.org/rfc/rfc1738.txt">RFC 1738</a>. Simply pass the
<code class="docutils literal notranslate"><span class="pre">user:password</span></code> before the host with an <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> sign:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span> <span class="nx">username</span> <span class="o">=</span> <span class="s1">&#39;username&#39;</span><span class="p">,</span>
    <span class="nx">password</span> <span class="o">=</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span>
    <span class="nx">url</span> <span class="o">=</span> <span class="s1">&#39;http://&#39;</span> <span class="o">+</span> <span class="nx">username</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="nx">password</span> <span class="o">+</span> <span class="s1">&#39;@some.server.com&#39;</span><span class="p">;</span>

<span class="nx">request</span><span class="p">({</span><span class="nx">url</span><span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
   <span class="c1">// Do more stuff with &#39;body&#39; here</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Digest authentication is supported, but it only works with <code class="docutils literal notranslate"><span class="pre">sendImmediately</span></code>
set to <code class="docutils literal notranslate"><span class="pre">false</span></code>; otherwise <code class="docutils literal notranslate"><span class="pre">request</span></code> will send basic authentication on the
initial request, which will probably cause the request to fail.</p>
<p>Bearer authentication is supported, and is activated when the <code class="docutils literal notranslate"><span class="pre">bearer</span></code> value is
available. The value may be either a <code class="docutils literal notranslate"><span class="pre">String</span></code> or a <code class="docutils literal notranslate"><span class="pre">Function</span></code> returning a
<code class="docutils literal notranslate"><span class="pre">String</span></code>. Using a function to supply the bearer token is particularly useful if
used in conjunction with <code class="docutils literal notranslate"><span class="pre">defaults</span></code> to allow a single function to supply the
last known token at the time of sending a request, or to compute one on the fly.</p>
<p><a class="reference external" href="#table-of-contents">back to top</a></p>
</div>
<hr class="docutils" />
<div class="section" id="custom-http-headers">
<h2>Custom HTTP Headers<a class="headerlink" href="#custom-http-headers" title="Permalink to this headline">¶</a></h2>
<p>HTTP Headers, such as <code class="docutils literal notranslate"><span class="pre">User-Agent</span></code>, can be set in the <code class="docutils literal notranslate"><span class="pre">options</span></code> object.
In the example below, we call the github API to find out the number
of stars and forks for the request repository. This requires a
custom <code class="docutils literal notranslate"><span class="pre">User-Agent</span></code> header as well as https.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;https://api.github.com/repos/request/request&#39;</span><span class="p">,</span>
  <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;User-Agent&#39;</span><span class="o">:</span> <span class="s1">&#39;request&#39;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kd">function</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">==</span> <span class="mf">200</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">info</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">body</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">info</span><span class="p">.</span><span class="nx">stargazers_count</span> <span class="o">+</span> <span class="s2">&quot; Stars&quot;</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">info</span><span class="p">.</span><span class="nx">forks_count</span> <span class="o">+</span> <span class="s2">&quot; Forks&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">request</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</pre></div>
</div>
<p><a class="reference external" href="#table-of-contents">back to top</a></p>
</div>
<hr class="docutils" />
<div class="section" id="oauth-signing">
<h2>OAuth Signing<a class="headerlink" href="#oauth-signing" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://tools.ietf.org/html/rfc5849">OAuth version 1.0</a> is supported. The
default signing algorithm is
<a class="reference external" href="https://tools.ietf.org/html/rfc5849#section-3.4.2">HMAC-SHA1</a>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// OAuth1.0 - 3-legged server side flow (Twitter example)</span>
<span class="c1">// step 1</span>
<span class="kd">const</span> <span class="nx">qs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;querystring&#39;</span><span class="p">)</span>
  <span class="p">,</span> <span class="nx">oauth</span> <span class="o">=</span>
    <span class="p">{</span> <span class="nx">callback</span><span class="o">:</span> <span class="s1">&#39;http://mysite.com/callback/&#39;</span>
    <span class="p">,</span> <span class="nx">consumer_key</span><span class="o">:</span> <span class="nx">CONSUMER_KEY</span>
    <span class="p">,</span> <span class="nx">consumer_secret</span><span class="o">:</span> <span class="nx">CONSUMER_SECRET</span>
    <span class="p">}</span>
  <span class="p">,</span> <span class="nx">url</span> <span class="o">=</span> <span class="s1">&#39;https://api.twitter.com/oauth/request_token&#39;</span>
  <span class="p">;</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span><span class="nx">url</span><span class="o">:</span><span class="nx">url</span><span class="p">,</span> <span class="nx">oauth</span><span class="o">:</span><span class="nx">oauth</span><span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Ideally, you would take the body in the response</span>
  <span class="c1">// and construct a URL that a user clicks on (like a sign in button).</span>
  <span class="c1">// The verifier is only available in the response after a user has</span>
  <span class="c1">// verified with twitter that they are authorizing your app.</span>

  <span class="c1">// step 2</span>
  <span class="kd">const</span> <span class="nx">req_data</span> <span class="o">=</span> <span class="nx">qs</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
  <span class="kd">const</span> <span class="nx">uri</span> <span class="o">=</span> <span class="s1">&#39;https://api.twitter.com/oauth/authenticate&#39;</span>
    <span class="o">+</span> <span class="s1">&#39;?&#39;</span> <span class="o">+</span> <span class="nx">qs</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span><span class="nx">oauth_token</span><span class="o">:</span> <span class="nx">req_data</span><span class="p">.</span><span class="nx">oauth_token</span><span class="p">})</span>
  <span class="c1">// redirect the user to the authorize uri</span>

  <span class="c1">// step 3</span>
  <span class="c1">// after the user is redirected back to your server</span>
  <span class="kd">const</span> <span class="nx">auth_data</span> <span class="o">=</span> <span class="nx">qs</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">oauth</span> <span class="o">=</span>
      <span class="p">{</span> <span class="nx">consumer_key</span><span class="o">:</span> <span class="nx">CONSUMER_KEY</span>
      <span class="p">,</span> <span class="nx">consumer_secret</span><span class="o">:</span> <span class="nx">CONSUMER_SECRET</span>
      <span class="p">,</span> <span class="nx">token</span><span class="o">:</span> <span class="nx">auth_data</span><span class="p">.</span><span class="nx">oauth_token</span>
      <span class="p">,</span> <span class="nx">token_secret</span><span class="o">:</span> <span class="nx">req_data</span><span class="p">.</span><span class="nx">oauth_token_secret</span>
      <span class="p">,</span> <span class="nx">verifier</span><span class="o">:</span> <span class="nx">auth_data</span><span class="p">.</span><span class="nx">oauth_verifier</span>
      <span class="p">}</span>
    <span class="p">,</span> <span class="nx">url</span> <span class="o">=</span> <span class="s1">&#39;https://api.twitter.com/oauth/access_token&#39;</span>
    <span class="p">;</span>
  <span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span><span class="nx">url</span><span class="o">:</span><span class="nx">url</span><span class="p">,</span> <span class="nx">oauth</span><span class="o">:</span><span class="nx">oauth</span><span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ready to make signed requests on behalf of the user</span>
    <span class="kd">const</span> <span class="nx">perm_data</span> <span class="o">=</span> <span class="nx">qs</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
      <span class="p">,</span> <span class="nx">oauth</span> <span class="o">=</span>
        <span class="p">{</span> <span class="nx">consumer_key</span><span class="o">:</span> <span class="nx">CONSUMER_KEY</span>
        <span class="p">,</span> <span class="nx">consumer_secret</span><span class="o">:</span> <span class="nx">CONSUMER_SECRET</span>
        <span class="p">,</span> <span class="nx">token</span><span class="o">:</span> <span class="nx">perm_data</span><span class="p">.</span><span class="nx">oauth_token</span>
        <span class="p">,</span> <span class="nx">token_secret</span><span class="o">:</span> <span class="nx">perm_data</span><span class="p">.</span><span class="nx">oauth_token_secret</span>
        <span class="p">}</span>
      <span class="p">,</span> <span class="nx">url</span> <span class="o">=</span> <span class="s1">&#39;https://api.twitter.com/1.1/users/show.json&#39;</span>
      <span class="p">,</span> <span class="nx">qs</span> <span class="o">=</span>
        <span class="p">{</span> <span class="nx">screen_name</span><span class="o">:</span> <span class="nx">perm_data</span><span class="p">.</span><span class="nx">screen_name</span>
        <span class="p">,</span> <span class="nx">user_id</span><span class="o">:</span> <span class="nx">perm_data</span><span class="p">.</span><span class="nx">user_id</span>
        <span class="p">}</span>
      <span class="p">;</span>
    <span class="nx">request</span><span class="p">.</span><span class="nx">get</span><span class="p">({</span><span class="nx">url</span><span class="o">:</span><span class="nx">url</span><span class="p">,</span> <span class="nx">oauth</span><span class="o">:</span><span class="nx">oauth</span><span class="p">,</span> <span class="nx">qs</span><span class="o">:</span><span class="nx">qs</span><span class="p">,</span> <span class="nx">json</span><span class="o">:</span><span class="kc">true</span><span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">user</span><span class="p">)</span>
    <span class="p">})</span>
  <span class="p">})</span>
<span class="p">})</span>
</pre></div>
</div>
<p>For <a class="reference external" href="https://tools.ietf.org/html/rfc5849#section-3.4.3">RSA-SHA1 signing</a>, make
the following changes to the OAuth options object:</p>
<ul class="simple">
<li><p>Pass <code class="docutils literal notranslate"><span class="pre">signature_method</span> <span class="pre">:</span> <span class="pre">'RSA-SHA1'</span></code></p></li>
<li><p>Instead of <code class="docutils literal notranslate"><span class="pre">consumer_secret</span></code>, specify a <code class="docutils literal notranslate"><span class="pre">private_key</span></code> string in
<a class="reference external" href="http://how2ssl.com/articles/working_with_pem_files/">PEM format</a></p></li>
</ul>
<p>For <a class="reference external" href="http://oauth.net/core/1.0/#anchor22">PLAINTEXT signing</a>, make
the following changes to the OAuth options object:</p>
<ul class="simple">
<li><p>Pass <code class="docutils literal notranslate"><span class="pre">signature_method</span> <span class="pre">:</span> <span class="pre">'PLAINTEXT'</span></code></p></li>
</ul>
<p>To send OAuth parameters via query params or in a post body as described in The
<a class="reference external" href="http://oauth.net/core/1.0/#consumer_req_param">Consumer Request Parameters</a>
section of the oauth1 spec:</p>
<ul class="simple">
<li><p>Pass <code class="docutils literal notranslate"><span class="pre">transport_method</span> <span class="pre">:</span> <span class="pre">'query'</span></code> or <code class="docutils literal notranslate"><span class="pre">transport_method</span> <span class="pre">:</span> <span class="pre">'body'</span></code> in the OAuth
options object.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transport_method</span></code> defaults to <code class="docutils literal notranslate"><span class="pre">'header'</span></code></p></li>
</ul>
<p>To use <a class="reference external" href="https://oauth.googlecode.com/svn/spec/ext/body_hash/1.0/oauth-bodyhash.html">Request Body Hash</a> you can either</p>
<ul class="simple">
<li><p>Manually generate the body hash and pass it as a string <code class="docutils literal notranslate"><span class="pre">body_hash:</span> <span class="pre">'...'</span></code></p></li>
<li><p>Automatically generate the body hash by passing <code class="docutils literal notranslate"><span class="pre">body_hash:</span> <span class="pre">true</span></code></p></li>
</ul>
<p><a class="reference external" href="#table-of-contents">back to top</a></p>
</div>
<hr class="docutils" />
<div class="section" id="proxies">
<h2>Proxies<a class="headerlink" href="#proxies" title="Permalink to this headline">¶</a></h2>
<p>If you specify a <code class="docutils literal notranslate"><span class="pre">proxy</span></code> option, then the request (and any subsequent
redirects) will be sent via a connection to the proxy server.</p>
<p>If your endpoint is an <code class="docutils literal notranslate"><span class="pre">https</span></code> url, and you are using a proxy, then
request will send a <code class="docutils literal notranslate"><span class="pre">CONNECT</span></code> request to the proxy server <em>first</em>, and
then use the supplied connection to connect to the endpoint.</p>
<p>That is, first it will make a request like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="n">CONNECT</span> <span class="n">endpoint</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="mi">80</span>
<span class="n">Host</span><span class="p">:</span> <span class="n">proxy</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">com</span>
<span class="n">User</span><span class="o">-</span><span class="n">Agent</span><span class="p">:</span> <span class="n">whatever</span> <span class="n">user</span> <span class="n">agent</span> <span class="n">you</span> <span class="n">specify</span>
</pre></div>
</div>
<p>and then the proxy server make a TCP connection to <code class="docutils literal notranslate"><span class="pre">endpoint-server</span></code>
on port <code class="docutils literal notranslate"><span class="pre">80</span></code>, and return a response that looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">200</span> <span class="n">OK</span>
</pre></div>
</div>
<p>At this point, the connection is left open, and the client is
communicating directly with the <code class="docutils literal notranslate"><span class="pre">endpoint-server.com</span></code> machine.</p>
<p>See <a class="reference external" href="https://en.wikipedia.org/wiki/HTTP_tunnel">the wikipedia page on HTTP Tunneling</a>
for more information.</p>
<p>By default, when proxying <code class="docutils literal notranslate"><span class="pre">http</span></code> traffic, request will simply make a
standard proxied <code class="docutils literal notranslate"><span class="pre">http</span></code> request. This is done by making the <code class="docutils literal notranslate"><span class="pre">url</span></code>
section of the initial line of the request a fully qualified url to
the endpoint.</p>
<p>For example, it will make a single request that looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="n">GET</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">endpoint</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">some</span><span class="o">-</span><span class="n">url</span>
<span class="n">Host</span><span class="p">:</span> <span class="n">proxy</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">com</span>
<span class="n">Other</span><span class="o">-</span><span class="n">Headers</span><span class="p">:</span> <span class="nb">all</span> <span class="n">go</span> <span class="n">here</span>

<span class="n">request</span> <span class="n">body</span> <span class="ow">or</span> <span class="n">whatever</span>
</pre></div>
</div>
<p>Because a pure “http over http” tunnel offers no additional security
or other features, it is generally simpler to go with a
straightforward HTTP proxy in this case. However, if you would like
to force a tunneling proxy, you may set the <code class="docutils literal notranslate"><span class="pre">tunnel</span></code> option to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>You can also make a standard proxied <code class="docutils literal notranslate"><span class="pre">http</span></code> request by explicitly setting
<code class="docutils literal notranslate"><span class="pre">tunnel</span> <span class="pre">:</span> <span class="pre">false</span></code>, but <strong>note that this will allow the proxy to see the traffic
to/from the destination server</strong>.</p>
<p>If you are using a tunneling proxy, you may set the
<code class="docutils literal notranslate"><span class="pre">proxyHeaderWhiteList</span></code> to share certain headers with the proxy.</p>
<p>You can also set the <code class="docutils literal notranslate"><span class="pre">proxyHeaderExclusiveList</span></code> to share certain
headers only with the proxy and not with destination host.</p>
<p>By default, this set is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">accept</span>
<span class="n">accept</span><span class="o">-</span><span class="n">charset</span>
<span class="n">accept</span><span class="o">-</span><span class="n">encoding</span>
<span class="n">accept</span><span class="o">-</span><span class="n">language</span>
<span class="n">accept</span><span class="o">-</span><span class="n">ranges</span>
<span class="n">cache</span><span class="o">-</span><span class="n">control</span>
<span class="n">content</span><span class="o">-</span><span class="n">encoding</span>
<span class="n">content</span><span class="o">-</span><span class="n">language</span>
<span class="n">content</span><span class="o">-</span><span class="n">length</span>
<span class="n">content</span><span class="o">-</span><span class="n">location</span>
<span class="n">content</span><span class="o">-</span><span class="n">md5</span>
<span class="n">content</span><span class="o">-</span><span class="nb">range</span>
<span class="n">content</span><span class="o">-</span><span class="nb">type</span>
<span class="n">connection</span>
<span class="n">date</span>
<span class="n">expect</span>
<span class="nb">max</span><span class="o">-</span><span class="n">forwards</span>
<span class="n">pragma</span>
<span class="n">proxy</span><span class="o">-</span><span class="n">authorization</span>
<span class="n">referer</span>
<span class="n">te</span>
<span class="n">transfer</span><span class="o">-</span><span class="n">encoding</span>
<span class="n">user</span><span class="o">-</span><span class="n">agent</span>
<span class="n">via</span>
</pre></div>
</div>
<p>Note that, when using a tunneling proxy, the <code class="docutils literal notranslate"><span class="pre">proxy-authorization</span></code>
header and any headers from custom <code class="docutils literal notranslate"><span class="pre">proxyHeaderExclusiveList</span></code> are
<em>never</em> sent to the endpoint server, but only to the proxy server.</p>
<div class="section" id="controlling-proxy-behaviour-using-environment-variables">
<h3>Controlling proxy behaviour using environment variables<a class="headerlink" href="#controlling-proxy-behaviour-using-environment-variables" title="Permalink to this headline">¶</a></h3>
<p>The following environment variables are respected by <code class="docutils literal notranslate"><span class="pre">request</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">HTTP_PROXY</span></code> / <code class="docutils literal notranslate"><span class="pre">http_proxy</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HTTPS_PROXY</span></code> / <code class="docutils literal notranslate"><span class="pre">https_proxy</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NO_PROXY</span></code> / <code class="docutils literal notranslate"><span class="pre">no_proxy</span></code></p></li>
</ul>
<p>When <code class="docutils literal notranslate"><span class="pre">HTTP_PROXY</span></code> / <code class="docutils literal notranslate"><span class="pre">http_proxy</span></code> are set, they will be used to proxy non-SSL requests that do not have an explicit <code class="docutils literal notranslate"><span class="pre">proxy</span></code> configuration option present. Similarly, <code class="docutils literal notranslate"><span class="pre">HTTPS_PROXY</span></code> / <code class="docutils literal notranslate"><span class="pre">https_proxy</span></code> will be respected for SSL requests that do not have an explicit <code class="docutils literal notranslate"><span class="pre">proxy</span></code> configuration option. It is valid to define a proxy in one of the environment variables, but then override it for a specific request, using the <code class="docutils literal notranslate"><span class="pre">proxy</span></code> configuration option. Furthermore, the <code class="docutils literal notranslate"><span class="pre">proxy</span></code> configuration option can be explicitly set to false / null to opt out of proxying altogether for that request.</p>
<p><code class="docutils literal notranslate"><span class="pre">request</span></code> is also aware of the <code class="docutils literal notranslate"><span class="pre">NO_PROXY</span></code>/<code class="docutils literal notranslate"><span class="pre">no_proxy</span></code> environment variables. These variables provide a granular way to opt out of proxying, on a per-host basis. It should contain a comma separated list of hosts to opt out of proxying. It is also possible to opt of proxying when a particular destination port is used. Finally, the variable may be set to <code class="docutils literal notranslate"><span class="pre">*</span></code> to opt out of the implicit proxy configuration of the other environment variables.</p>
<p>Here’s some examples of valid <code class="docutils literal notranslate"><span class="pre">no_proxy</span></code> values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">google.com</span></code> - don’t proxy HTTP/HTTPS requests to Google.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">google.com:443</span></code> - don’t proxy HTTPS requests to Google, but <em>do</em> proxy HTTP requests to Google.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">google.com:443,</span> <span class="pre">yahoo.com:80</span></code> - don’t proxy HTTPS requests to Google, and don’t proxy HTTP requests to Yahoo!</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">*</span></code> - ignore <code class="docutils literal notranslate"><span class="pre">https_proxy</span></code>/<code class="docutils literal notranslate"><span class="pre">http_proxy</span></code> environment variables altogether.</p></li>
</ul>
<p><a class="reference external" href="#table-of-contents">back to top</a></p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="unix-domain-sockets">
<h2>UNIX Domain Sockets<a class="headerlink" href="#unix-domain-sockets" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">request</span></code> supports making requests to <a class="reference external" href="https://en.wikipedia.org/wiki/Unix_domain_socket">UNIX Domain Sockets</a>. To make one, use the following URL scheme:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Pattern */</span> <span class="s1">&#39;http://unix:SOCKET:PATH&#39;</span>
<span class="cm">/* Example */</span> <span class="nx">request</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;http://unix:/absolute/path/to/unix.socket:/request/path&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note: The <code class="docutils literal notranslate"><span class="pre">SOCKET</span></code> path is assumed to be absolute to the root of the host file system.</p>
<p><a class="reference external" href="#table-of-contents">back to top</a></p>
</div>
<hr class="docutils" />
<div class="section" id="tls-ssl-protocol">
<h2>TLS/SSL Protocol<a class="headerlink" href="#tls-ssl-protocol" title="Permalink to this headline">¶</a></h2>
<p>TLS/SSL Protocol options, such as <code class="docutils literal notranslate"><span class="pre">cert</span></code>, <code class="docutils literal notranslate"><span class="pre">key</span></code> and <code class="docutils literal notranslate"><span class="pre">passphrase</span></code>, can be
set directly in <code class="docutils literal notranslate"><span class="pre">options</span></code> object, in the <code class="docutils literal notranslate"><span class="pre">agentOptions</span></code> property of the <code class="docutils literal notranslate"><span class="pre">options</span></code> object, or even in <code class="docutils literal notranslate"><span class="pre">https.globalAgent.options</span></code>. Keep in mind that, although <code class="docutils literal notranslate"><span class="pre">agentOptions</span></code> allows for a slightly wider range of configurations, the recommended way is via <code class="docutils literal notranslate"><span class="pre">options</span></code> object directly, as using <code class="docutils literal notranslate"><span class="pre">agentOptions</span></code> or <code class="docutils literal notranslate"><span class="pre">https.globalAgent.options</span></code> would not be applied in the same way in proxied environments (as data travels through a TLS connection instead of an http/https agent).</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">certFile</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">&#39;ssl/client.crt&#39;</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">keyFile</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">&#39;ssl/client.key&#39;</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">caFile</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">&#39;ssl/ca.cert.pem&#39;</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;https://api.some-server.com/&#39;</span><span class="p">,</span>
    <span class="nx">cert</span><span class="o">:</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">certFile</span><span class="p">),</span>
    <span class="nx">key</span><span class="o">:</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">keyFile</span><span class="p">),</span>
    <span class="nx">passphrase</span><span class="o">:</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span>
    <span class="nx">ca</span><span class="o">:</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">caFile</span><span class="p">)</span>
<span class="p">};</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
</pre></div>
</div>
<div class="section" id="using-options-agentoptions">
<h3>Using <code class="docutils literal notranslate"><span class="pre">options.agentOptions</span></code><a class="headerlink" href="#using-options-agentoptions" title="Permalink to this headline">¶</a></h3>
<p>In the example below, we call an API that requires client side SSL certificate
(in PEM format) with passphrase protected private key (in PEM format) and disable the SSLv3 protocol:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">certFile</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">&#39;ssl/client.crt&#39;</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">keyFile</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">&#39;ssl/client.key&#39;</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;https://api.some-server.com/&#39;</span><span class="p">,</span>
    <span class="nx">agentOptions</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">cert</span><span class="o">:</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">certFile</span><span class="p">),</span>
        <span class="nx">key</span><span class="o">:</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">keyFile</span><span class="p">),</span>
        <span class="c1">// Or use `pfx` property replacing `cert` and `key` when using private key, certificate and CA certs in PFX or PKCS12 format:</span>
        <span class="c1">// pfx: fs.readFileSync(pfxFilePath),</span>
        <span class="nx">passphrase</span><span class="o">:</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span>
        <span class="nx">securityOptions</span><span class="o">:</span> <span class="s1">&#39;SSL_OP_NO_SSLv3&#39;</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
</pre></div>
</div>
<p>It is able to force using SSLv3 only by specifying <code class="docutils literal notranslate"><span class="pre">secureProtocol</span></code>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">request</span><span class="p">.</span><span class="nx">get</span><span class="p">({</span>
    <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;https://api.some-server.com/&#39;</span><span class="p">,</span>
    <span class="nx">agentOptions</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">secureProtocol</span><span class="o">:</span> <span class="s1">&#39;SSLv3_method&#39;</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p>It is possible to accept other certificates than those signed by generally allowed Certificate Authorities (CAs).
This can be useful, for example,  when using self-signed certificates.
To require a different root certificate, you can specify the signing CA by adding the contents of the CA’s certificate file to the <code class="docutils literal notranslate"><span class="pre">agentOptions</span></code>.
The certificate the domain presents must be signed by the root certificate specified:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">request</span><span class="p">.</span><span class="nx">get</span><span class="p">({</span>
    <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;https://api.some-server.com/&#39;</span><span class="p">,</span>
    <span class="nx">agentOptions</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">ca</span><span class="o">:</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="s1">&#39;ca.cert.pem&#39;</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ca</span></code> value can be an array of certificates, in the event you have a private or internal corporate public-key infrastructure hierarchy. For example, if you want to connect to <a class="reference external" href="https://api.some-server.com">https://api.some-server.com</a> which presents a key chain consisting of:</p>
<ol class="simple">
<li><p>its own public key, which is signed by:</p></li>
<li><p>an intermediate “Corp Issuing Server”, that is in turn signed by:</p></li>
<li><p>a root CA “Corp Root CA”;</p></li>
</ol>
<p>you can configure your request as follows:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">request</span><span class="p">.</span><span class="nx">get</span><span class="p">({</span>
    <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;https://api.some-server.com/&#39;</span><span class="p">,</span>
    <span class="nx">agentOptions</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">ca</span><span class="o">:</span> <span class="p">[</span>
          <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="s1">&#39;Corp Issuing Server.pem&#39;</span><span class="p">),</span>
          <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="s1">&#39;Corp Root CA.pem&#39;</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p><a class="reference external" href="#table-of-contents">back to top</a></p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="support-for-har-1-2">
<h2>Support for HAR 1.2<a class="headerlink" href="#support-for-har-1-2" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">options.har</span></code> property will override the values: <code class="docutils literal notranslate"><span class="pre">url</span></code>, <code class="docutils literal notranslate"><span class="pre">method</span></code>, <code class="docutils literal notranslate"><span class="pre">qs</span></code>, <code class="docutils literal notranslate"><span class="pre">headers</span></code>, <code class="docutils literal notranslate"><span class="pre">form</span></code>, <code class="docutils literal notranslate"><span class="pre">formData</span></code>, <code class="docutils literal notranslate"><span class="pre">body</span></code>, <code class="docutils literal notranslate"><span class="pre">json</span></code>, as well as construct multipart data and read files from disk when <code class="docutils literal notranslate"><span class="pre">request.postData.params[].fileName</span></code> is present without a matching <code class="docutils literal notranslate"><span class="pre">value</span></code>.</p>
<p>A validation step will check if the HAR Request format matches the latest spec (v1.2) and will skip parsing if not matching.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span>  <span class="kd">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">)</span>
  <span class="nx">request</span><span class="p">({</span>
    <span class="c1">// will be ignored</span>
    <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;GET&#39;</span><span class="p">,</span>
    <span class="nx">uri</span><span class="o">:</span> <span class="s1">&#39;http://www.google.com&#39;</span><span class="p">,</span>

    <span class="c1">// HTTP Archive Request Object</span>
    <span class="nx">har</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.mockbin.com/har&#39;</span><span class="p">,</span>
      <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
      <span class="nx">headers</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;content-type&#39;</span><span class="p">,</span>
          <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;application/x-www-form-urlencoded&#39;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="nx">postData</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">mimeType</span><span class="o">:</span> <span class="s1">&#39;application/x-www-form-urlencoded&#39;</span><span class="p">,</span>
        <span class="nx">params</span><span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
            <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;bar&#39;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span>
            <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;world&#39;</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">})</span>

  <span class="c1">// a POST request will be sent to http://www.mockbin.com</span>
  <span class="c1">// with body an application/x-www-form-urlencoded body:</span>
  <span class="c1">// foo=bar&amp;hello=world</span>
</pre></div>
</div>
<p><a class="reference external" href="#table-of-contents">back to top</a></p>
</div>
<hr class="docutils" />
<div class="section" id="request-options-callback">
<h2>request(options, callback)<a class="headerlink" href="#request-options-callback" title="Permalink to this headline">¶</a></h2>
<p>The first argument can be either a <code class="docutils literal notranslate"><span class="pre">url</span></code> or an <code class="docutils literal notranslate"><span class="pre">options</span></code> object. The only required option is <code class="docutils literal notranslate"><span class="pre">uri</span></code>; all others are optional.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">uri</span></code> || <code class="docutils literal notranslate"><span class="pre">url</span></code> - fully qualified uri or a parsed url object from <code class="docutils literal notranslate"><span class="pre">url.parse()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">baseUrl</span></code> - fully qualified uri string used as the base url. Most useful with <code class="docutils literal notranslate"><span class="pre">request.defaults</span></code>, for example when you want to do many requests to the same domain. If <code class="docutils literal notranslate"><span class="pre">baseUrl</span></code> is <code class="docutils literal notranslate"><span class="pre">https://example.com/api/</span></code>, then requesting <code class="docutils literal notranslate"><span class="pre">/end/point?test=true</span></code> will fetch <code class="docutils literal notranslate"><span class="pre">https://example.com/api/end/point?test=true</span></code>. When <code class="docutils literal notranslate"><span class="pre">baseUrl</span></code> is given, <code class="docutils literal notranslate"><span class="pre">uri</span></code> must also be a string.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">method</span></code> - http method (default: <code class="docutils literal notranslate"><span class="pre">&quot;GET&quot;</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">headers</span></code> - http headers (default: <code class="docutils literal notranslate"><span class="pre">{}</span></code>)</p></li>
</ul>
<hr class="docutils" />
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">qs</span></code> - object containing querystring values to be appended to the <code class="docutils literal notranslate"><span class="pre">uri</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">qsParseOptions</span></code> - object containing options to pass to the <a class="reference external" href="https://github.com/hapijs/qs#parsing-objects">qs.parse</a> method. Alternatively pass options to the <a class="reference external" href="https://nodejs.org/docs/v0.12.0/api/querystring.html#querystring_querystring_parse_str_sep_eq_options">querystring.parse</a> method using this format <code class="docutils literal notranslate"><span class="pre">{sep:';',</span> <span class="pre">eq:':',</span> <span class="pre">options:{}}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">qsStringifyOptions</span></code> - object containing options to pass to the <a class="reference external" href="https://github.com/hapijs/qs#stringifying">qs.stringify</a> method. Alternatively pass options to the  <a class="reference external" href="https://nodejs.org/docs/v0.12.0/api/querystring.html#querystring_querystring_stringify_obj_sep_eq_options">querystring.stringify</a> method using this format <code class="docutils literal notranslate"><span class="pre">{sep:';',</span> <span class="pre">eq:':',</span> <span class="pre">options:{}}</span></code>. For example, to change the way arrays are converted to query strings using the <code class="docutils literal notranslate"><span class="pre">qs</span></code> module pass the <code class="docutils literal notranslate"><span class="pre">arrayFormat</span></code> option with one of <code class="docutils literal notranslate"><span class="pre">indices|brackets|repeat</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">useQuerystring</span></code> - if true, use <code class="docutils literal notranslate"><span class="pre">querystring</span></code> to stringify and parse
querystrings, otherwise use <code class="docutils literal notranslate"><span class="pre">qs</span></code> (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>). Set this option to
<code class="docutils literal notranslate"><span class="pre">true</span></code> if you need arrays to be serialized as <code class="docutils literal notranslate"><span class="pre">foo=bar&amp;foo=baz</span></code> instead of the
default <code class="docutils literal notranslate"><span class="pre">foo[0]=bar&amp;foo[1]=baz</span></code>.</p></li>
</ul>
<hr class="docutils" />
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code> - entity body for PATCH, POST and PUT requests. Must be a <code class="docutils literal notranslate"><span class="pre">Buffer</span></code>, <code class="docutils literal notranslate"><span class="pre">String</span></code> or <code class="docutils literal notranslate"><span class="pre">ReadStream</span></code>. If <code class="docutils literal notranslate"><span class="pre">json</span></code> is <code class="docutils literal notranslate"><span class="pre">true</span></code>, then <code class="docutils literal notranslate"><span class="pre">body</span></code> must be a JSON-serializable object.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">form</span></code> - when passed an object or a querystring, this sets <code class="docutils literal notranslate"><span class="pre">body</span></code> to a querystring representation of value, and adds <code class="docutils literal notranslate"><span class="pre">Content-type:</span> <span class="pre">application/x-www-form-urlencoded</span></code> header. When passed no options, a <code class="docutils literal notranslate"><span class="pre">FormData</span></code> instance is returned (and is piped to request). See “Forms” section above.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">formData</span></code> - data to pass for a <code class="docutils literal notranslate"><span class="pre">multipart/form-data</span></code> request. See
<a class="reference external" href="#forms">Forms</a> section above.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">multipart</span></code> - array of objects which contain their own headers and <code class="docutils literal notranslate"><span class="pre">body</span></code>
attributes. Sends a <code class="docutils literal notranslate"><span class="pre">multipart/related</span></code> request. See <a class="reference external" href="#forms">Forms</a> section
above.</p>
<ul>
<li><p>Alternatively you can pass in an object <code class="docutils literal notranslate"><span class="pre">{chunked:</span> <span class="pre">false,</span> <span class="pre">data:</span> <span class="pre">[]}</span></code> where
<code class="docutils literal notranslate"><span class="pre">chunked</span></code> is used to specify whether the request is sent in
<a class="reference external" href="https://en.wikipedia.org/wiki/Chunked_transfer_encoding">chunked transfer encoding</a>
In non-chunked requests, data items with body streams are not allowed.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">preambleCRLF</span></code> - append a newline/CRLF before the boundary of your <code class="docutils literal notranslate"><span class="pre">multipart/form-data</span></code> request.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">postambleCRLF</span></code> - append a newline/CRLF at the end of the boundary of your <code class="docutils literal notranslate"><span class="pre">multipart/form-data</span></code> request.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">json</span></code> - sets <code class="docutils literal notranslate"><span class="pre">body</span></code> to JSON representation of value and adds <code class="docutils literal notranslate"><span class="pre">Content-type:</span> <span class="pre">application/json</span></code> header. Additionally, parses the response body as JSON.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jsonReviver</span></code> - a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse">reviver function</a> that will be passed to <code class="docutils literal notranslate"><span class="pre">JSON.parse()</span></code> when parsing a JSON response body.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jsonReplacer</span></code> - a <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify">replacer function</a> that will be passed to <code class="docutils literal notranslate"><span class="pre">JSON.stringify()</span></code> when stringifying a JSON request body.</p></li>
</ul>
<hr class="docutils" />
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">auth</span></code> - a hash containing values <code class="docutils literal notranslate"><span class="pre">user</span></code> || <code class="docutils literal notranslate"><span class="pre">username</span></code>, <code class="docutils literal notranslate"><span class="pre">pass</span></code> || <code class="docutils literal notranslate"><span class="pre">password</span></code>, and <code class="docutils literal notranslate"><span class="pre">sendImmediately</span></code> (optional). See documentation above.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">oauth</span></code> - options for OAuth HMAC-SHA1 signing. See documentation above.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hawk</span></code> - options for <a class="reference external" href="https://github.com/hueniverse/hawk">Hawk signing</a>. The <code class="docutils literal notranslate"><span class="pre">credentials</span></code> key must contain the necessary signing info, <a class="reference external" href="https://github.com/hueniverse/hawk#usage-example">see hawk docs for details</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aws</span></code> - <code class="docutils literal notranslate"><span class="pre">object</span></code> containing AWS signing information. Should have the properties <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">secret</span></code>, and optionally <code class="docutils literal notranslate"><span class="pre">session</span></code> (note that this only works for services that require session as part of the canonical string). Also requires the property <code class="docutils literal notranslate"><span class="pre">bucket</span></code>, unless you’re specifying your <code class="docutils literal notranslate"><span class="pre">bucket</span></code> as part of the path, or the request doesn’t use a bucket (i.e. GET Services). If you want to use AWS sign version 4 use the parameter <code class="docutils literal notranslate"><span class="pre">sign_version</span></code> with value <code class="docutils literal notranslate"><span class="pre">4</span></code> otherwise the default is version 2. If you are using SigV4, you can also include a <code class="docutils literal notranslate"><span class="pre">service</span></code> property that specifies the service name. <strong>Note:</strong> you need to <code class="docutils literal notranslate"><span class="pre">npm</span> <span class="pre">install</span> <span class="pre">aws4</span></code> first.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">httpSignature</span></code> - options for the <a class="reference external" href="https://github.com/joyent/node-http-signature/blob/master/http_signing.md">HTTP Signature Scheme</a> using <a class="reference external" href="https://github.com/joyent/node-http-signature">Joyent’s library</a>. The <code class="docutils literal notranslate"><span class="pre">keyId</span></code> and <code class="docutils literal notranslate"><span class="pre">key</span></code> properties must be specified. See the docs for other options.</p></li>
</ul>
<hr class="docutils" />
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">followRedirect</span></code> - follow HTTP 3xx responses as redirects (default: <code class="docutils literal notranslate"><span class="pre">true</span></code>). This property can also be implemented as function which gets <code class="docutils literal notranslate"><span class="pre">response</span></code> object as a single argument and should return <code class="docutils literal notranslate"><span class="pre">true</span></code> if redirects should continue or <code class="docutils literal notranslate"><span class="pre">false</span></code> otherwise.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">followAllRedirects</span></code> - follow non-GET HTTP 3xx responses as redirects (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">followOriginalHttpMethod</span></code> - by default we redirect to HTTP method GET. you can enable this property to redirect to the original HTTP method (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maxRedirects</span></code> - the maximum number of redirects to follow (default: <code class="docutils literal notranslate"><span class="pre">10</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">removeRefererHeader</span></code> - removes the referer header when a redirect happens (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>). <strong>Note:</strong> if true, referer header set in the initial request is preserved during redirect chain.</p></li>
</ul>
<hr class="docutils" />
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">encoding</span></code> - encoding to be used on <code class="docutils literal notranslate"><span class="pre">setEncoding</span></code> of response data. If <code class="docutils literal notranslate"><span class="pre">null</span></code>, the <code class="docutils literal notranslate"><span class="pre">body</span></code> is returned as a <code class="docutils literal notranslate"><span class="pre">Buffer</span></code>. Anything else <strong>(including the default value of <code class="docutils literal notranslate"><span class="pre">undefined</span></code>)</strong> will be passed as the <a class="reference external" href="http://nodejs.org/api/buffer.html#buffer_buffer">encoding</a> parameter to <code class="docutils literal notranslate"><span class="pre">toString()</span></code> (meaning this is effectively <code class="docutils literal notranslate"><span class="pre">utf8</span></code> by default). (<strong>Note:</strong> if you expect binary data, you should set <code class="docutils literal notranslate"><span class="pre">encoding:</span> <span class="pre">null</span></code>.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gzip</span></code> - if <code class="docutils literal notranslate"><span class="pre">true</span></code>, add an <code class="docutils literal notranslate"><span class="pre">Accept-Encoding</span></code> header to request compressed content encodings from the server (if not already present) and decode supported content encodings in the response. <strong>Note:</strong> Automatic decoding of the response content is performed on the body data returned through <code class="docutils literal notranslate"><span class="pre">request</span></code> (both through the <code class="docutils literal notranslate"><span class="pre">request</span></code> stream and passed to the callback function) but is not performed on the <code class="docutils literal notranslate"><span class="pre">response</span></code> stream (available from the <code class="docutils literal notranslate"><span class="pre">response</span></code> event) which is the unmodified <code class="docutils literal notranslate"><span class="pre">http.IncomingMessage</span></code> object which may contain compressed data. See example below.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jar</span></code> - if <code class="docutils literal notranslate"><span class="pre">true</span></code>, remember cookies for future use (or define your custom cookie jar; see examples section)</p></li>
</ul>
<hr class="docutils" />
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">agent</span></code> - <code class="docutils literal notranslate"><span class="pre">http(s).Agent</span></code> instance to use</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">agentClass</span></code> - alternatively specify your agent’s class name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">agentOptions</span></code> - and pass its options. <strong>Note:</strong> for HTTPS see <a class="reference external" href="http://nodejs.org/api/tls.html#tls_tls_connect_options_callback">tls API doc for TLS/SSL options</a> and the <a class="reference external" href="#using-optionsagentoptions">documentation above</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forever</span></code> - set to <code class="docutils literal notranslate"><span class="pre">true</span></code> to use the <a class="reference external" href="https://github.com/request/forever-agent">forever-agent</a> <strong>Note:</strong> Defaults to <code class="docutils literal notranslate"><span class="pre">http(s).Agent({keepAlive:true})</span></code> in node 0.12+</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pool</span></code> - an object describing which agents to use for the request. If this option is omitted the request will use the global agent (as long as your options allow for it). Otherwise, request will search the pool for your custom agent. If no custom agent is found, a new agent will be created and added to the pool. <strong>Note:</strong> <code class="docutils literal notranslate"><span class="pre">pool</span></code> is used only when the <code class="docutils literal notranslate"><span class="pre">agent</span></code> option is not specified.</p>
<ul>
<li><p>A <code class="docutils literal notranslate"><span class="pre">maxSockets</span></code> property can also be provided on the <code class="docutils literal notranslate"><span class="pre">pool</span></code> object to set the max number of sockets for all agents created (ex: <code class="docutils literal notranslate"><span class="pre">pool:</span> <span class="pre">{maxSockets:</span> <span class="pre">Infinity}</span></code>).</p></li>
<li><p>Note that if you are sending multiple requests in a loop and creating
multiple new <code class="docutils literal notranslate"><span class="pre">pool</span></code> objects, <code class="docutils literal notranslate"><span class="pre">maxSockets</span></code> will not work as intended. To
work around this, either use <a class="reference external" href="#requestdefaultsoptions"><code class="docutils literal notranslate"><span class="pre">request.defaults</span></code></a>
with your pool options or create the pool object with the <code class="docutils literal notranslate"><span class="pre">maxSockets</span></code>
property outside of the loop.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">timeout</span></code> - integer containing number of milliseconds, controls two timeouts.</p>
<ul>
<li><p><strong>Read timeout</strong>: Time to wait for a server to send response headers (and start the response body) before aborting the request.</p></li>
<li><p><strong>Connection timeout</strong>: Sets the socket to timeout after <code class="docutils literal notranslate"><span class="pre">timeout</span></code> milliseconds of inactivity. Note that increasing the timeout beyond the OS-wide TCP connection timeout will not have any effect (<a class="reference external" href="http://www.sekuda.com/overriding_the_default_linux_kernel_20_second_tcp_socket_connect_timeout">the default in Linux can be anywhere from 20-120 seconds</a>)</p></li>
</ul>
</li>
</ul>
<hr class="docutils" />
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">localAddress</span></code> - local interface to bind for network connections.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proxy</span></code> - an HTTP proxy to be used. Supports proxy Auth with Basic Auth, identical to support for the <code class="docutils literal notranslate"><span class="pre">url</span></code> parameter (by embedding the auth info in the <code class="docutils literal notranslate"><span class="pre">uri</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">strictSSL</span></code> - if <code class="docutils literal notranslate"><span class="pre">true</span></code>, requires SSL certificates be valid. <strong>Note:</strong> to use your own certificate authority, you need to specify an agent that was created with that CA as an option.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tunnel</span></code> - controls the behavior of
<a class="reference external" href="https://en.wikipedia.org/wiki/HTTP_tunnel#HTTP_CONNECT_tunneling">HTTP <code class="docutils literal notranslate"><span class="pre">CONNECT</span></code> tunneling</a>
as follows:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">undefined</span></code> (default) - <code class="docutils literal notranslate"><span class="pre">true</span></code> if the destination is <code class="docutils literal notranslate"><span class="pre">https</span></code>, <code class="docutils literal notranslate"><span class="pre">false</span></code> otherwise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">true</span></code> - always tunnel to the destination by making a <code class="docutils literal notranslate"><span class="pre">CONNECT</span></code> request to
the proxy</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">false</span></code> - request the destination as a <code class="docutils literal notranslate"><span class="pre">GET</span></code> request.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">proxyHeaderWhiteList</span></code> - a whitelist of headers to send to a
tunneling proxy.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proxyHeaderExclusiveList</span></code> - a whitelist of headers to send
exclusively to a tunneling proxy and not to destination.</p></li>
</ul>
<hr class="docutils" />
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">time</span></code> - if <code class="docutils literal notranslate"><span class="pre">true</span></code>, the request-response cycle (including all redirects) is timed at millisecond resolution. When set, the following properties are added to the response object:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">elapsedTime</span></code> Duration of the entire request/response in milliseconds (<em>deprecated</em>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">responseStartTime</span></code> Timestamp when the response began (in Unix Epoch milliseconds) (<em>deprecated</em>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timingStart</span></code> Timestamp of the start of the request (in Unix Epoch milliseconds).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timings</span></code> Contains event timestamps in millisecond resolution relative to <code class="docutils literal notranslate"><span class="pre">timingStart</span></code>. If there were redirects, the properties reflect the timings of the final request in the redirect chain:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">socket</span></code> Relative timestamp when the <a class="reference external" href="https://nodejs.org/api/http.html#http_event_socket"><code class="docutils literal notranslate"><span class="pre">http</span></code></a> module’s <code class="docutils literal notranslate"><span class="pre">socket</span></code> event fires. This happens when the socket is assigned to the request.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lookup</span></code> Relative timestamp when the <a class="reference external" href="https://nodejs.org/api/net.html#net_event_lookup"><code class="docutils literal notranslate"><span class="pre">net</span></code></a> module’s <code class="docutils literal notranslate"><span class="pre">lookup</span></code> event fires. This happens when the DNS has been resolved.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">connect</span></code>: Relative timestamp when the <a class="reference external" href="https://nodejs.org/api/net.html#net_event_connect"><code class="docutils literal notranslate"><span class="pre">net</span></code></a> module’s <code class="docutils literal notranslate"><span class="pre">connect</span></code> event fires. This happens when the server acknowledges the TCP connection.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">response</span></code>: Relative timestamp when the <a class="reference external" href="https://nodejs.org/api/http.html#http_event_response"><code class="docutils literal notranslate"><span class="pre">http</span></code></a> module’s <code class="docutils literal notranslate"><span class="pre">response</span></code> event fires. This happens when the first bytes are received from the server.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">end</span></code>: Relative timestamp when the last bytes of the response are received.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">timingPhases</span></code> Contains the durations of each request phase. If there were redirects, the properties reflect the timings of the final request in the redirect chain:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">wait</span></code>: Duration of socket initialization (<code class="docutils literal notranslate"><span class="pre">timings.socket</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dns</span></code>: Duration of DNS lookup (<code class="docutils literal notranslate"><span class="pre">timings.lookup</span></code> - <code class="docutils literal notranslate"><span class="pre">timings.socket</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tcp</span></code>: Duration of TCP connection (<code class="docutils literal notranslate"><span class="pre">timings.connect</span></code> - <code class="docutils literal notranslate"><span class="pre">timings.socket</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">firstByte</span></code>: Duration of HTTP server response (<code class="docutils literal notranslate"><span class="pre">timings.response</span></code> - <code class="docutils literal notranslate"><span class="pre">timings.connect</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">download</span></code>: Duration of HTTP download (<code class="docutils literal notranslate"><span class="pre">timings.end</span></code> - <code class="docutils literal notranslate"><span class="pre">timings.response</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total</span></code>: Duration entire HTTP round-trip (<code class="docutils literal notranslate"><span class="pre">timings.end</span></code>)</p></li>
</ul>
</li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">har</span></code> - a <a class="reference external" href="http://www.softwareishard.com/blog/har-12-spec/#request">HAR 1.2 Request Object</a>, will be processed from HAR format into options overwriting matching values <em>(see the <a class="reference external" href="#support-for-har-12">HAR 1.2 section</a> for details)</em></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">callback</span></code> - alternatively pass the request’s callback in the options object</p></li>
</ul>
<p>The callback argument gets 3 arguments:</p>
<ol class="simple">
<li><p>An <code class="docutils literal notranslate"><span class="pre">error</span></code> when applicable (usually from <a class="reference external" href="http://nodejs.org/api/http.html#http_class_http_clientrequest"><code class="docutils literal notranslate"><span class="pre">http.ClientRequest</span></code></a> object)</p></li>
<li><p>An <a class="reference external" href="https://nodejs.org/api/http.html#http_class_http_incomingmessage"><code class="docutils literal notranslate"><span class="pre">http.IncomingMessage</span></code></a> object (Response object)</p></li>
<li><p>The third is the <code class="docutils literal notranslate"><span class="pre">response</span></code> body (<code class="docutils literal notranslate"><span class="pre">String</span></code> or <code class="docutils literal notranslate"><span class="pre">Buffer</span></code>, or JSON object if the <code class="docutils literal notranslate"><span class="pre">json</span></code> option is supplied)</p></li>
</ol>
<p><a class="reference external" href="#table-of-contents">back to top</a></p>
</div>
<hr class="docutils" />
<div class="section" id="convenience-methods">
<h2>Convenience methods<a class="headerlink" href="#convenience-methods" title="Permalink to this headline">¶</a></h2>
<p>There are also shorthand methods for different HTTP METHODs and some other conveniences.</p>
<div class="section" id="request-defaults-options">
<h3>request.defaults(options)<a class="headerlink" href="#request-defaults-options" title="Permalink to this headline">¶</a></h3>
<p>This method <strong>returns a wrapper</strong> around the normal request API that defaults
to whatever options you pass to it.</p>
<p><strong>Note:</strong> <code class="docutils literal notranslate"><span class="pre">request.defaults()</span></code> <strong>does not</strong> modify the global request API;
instead, it <strong>returns a wrapper</strong> that has your default settings applied to it.</p>
<p><strong>Note:</strong> You can call <code class="docutils literal notranslate"><span class="pre">.defaults()</span></code> on the wrapper that is returned from
<code class="docutils literal notranslate"><span class="pre">request.defaults</span></code> to add/override defaults that were previously defaulted.</p>
<p>For example:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">//requests using baseRequest() will set the &#39;x-token&#39; header</span>
<span class="kd">const</span> <span class="nx">baseRequest</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">defaults</span><span class="p">({</span>
  <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;x-token&#39;</span><span class="o">:</span> <span class="s1">&#39;my-token&#39;</span><span class="p">}</span>
<span class="p">})</span>

<span class="c1">//requests using specialRequest() will include the &#39;x-token&#39; header set in</span>
<span class="c1">//baseRequest and will also include the &#39;special&#39; header</span>
<span class="kd">const</span> <span class="nx">specialRequest</span> <span class="o">=</span> <span class="nx">baseRequest</span><span class="p">.</span><span class="nx">defaults</span><span class="p">({</span>
  <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span><span class="nx">special</span><span class="o">:</span> <span class="s1">&#39;special value&#39;</span><span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="request-method">
<h3>request.METHOD()<a class="headerlink" href="#request-method" title="Permalink to this headline">¶</a></h3>
<p>These HTTP method convenience functions act just like <code class="docutils literal notranslate"><span class="pre">request()</span></code> but with a default method already set for you:</p>
<ul class="simple">
<li><p><em>request.get()</em>: Defaults to <code class="docutils literal notranslate"><span class="pre">method:</span> <span class="pre">&quot;GET&quot;</span></code>.</p></li>
<li><p><em>request.post()</em>: Defaults to <code class="docutils literal notranslate"><span class="pre">method:</span> <span class="pre">&quot;POST&quot;</span></code>.</p></li>
<li><p><em>request.put()</em>: Defaults to <code class="docutils literal notranslate"><span class="pre">method:</span> <span class="pre">&quot;PUT&quot;</span></code>.</p></li>
<li><p><em>request.patch()</em>: Defaults to <code class="docutils literal notranslate"><span class="pre">method:</span> <span class="pre">&quot;PATCH&quot;</span></code>.</p></li>
<li><p><em>request.del() / request.delete()</em>: Defaults to <code class="docutils literal notranslate"><span class="pre">method:</span> <span class="pre">&quot;DELETE&quot;</span></code>.</p></li>
<li><p><em>request.head()</em>: Defaults to <code class="docutils literal notranslate"><span class="pre">method:</span> <span class="pre">&quot;HEAD&quot;</span></code>.</p></li>
<li><p><em>request.options()</em>: Defaults to <code class="docutils literal notranslate"><span class="pre">method:</span> <span class="pre">&quot;OPTIONS&quot;</span></code>.</p></li>
</ul>
</div>
<div class="section" id="request-cookie">
<h3>request.cookie()<a class="headerlink" href="#request-cookie" title="Permalink to this headline">¶</a></h3>
<p>Function that creates a new cookie.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">request</span><span class="p">.</span><span class="nx">cookie</span><span class="p">(</span><span class="s1">&#39;key1=value1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="request-jar">
<h3>request.jar()<a class="headerlink" href="#request-jar" title="Permalink to this headline">¶</a></h3>
<p>Function that creates a new cookie jar.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">request</span><span class="p">.</span><span class="nx">jar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="response-caseless-get-header-name">
<h3>response.caseless.get(‘header-name’)<a class="headerlink" href="#response-caseless-get-header-name" title="Permalink to this headline">¶</a></h3>
<p>Function that returns the specified response header field using a <a class="reference external" href="https://tools.ietf.org/html/rfc7230#section-3.2">case-insensitive match</a></p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">request</span><span class="p">(</span><span class="s1">&#39;http://www.google.com&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// print the Content-Type header even if the server returned it as &#39;content-type&#39; (lowercase)</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Content-Type is:&#39;</span><span class="p">,</span> <span class="nx">response</span><span class="p">.</span><span class="nx">caseless</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">));</span> 
<span class="p">});</span>
</pre></div>
</div>
<p><a class="reference external" href="#table-of-contents">back to top</a></p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="debugging">
<h2>Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline">¶</a></h2>
<p>There are at least three ways to debug the operation of <code class="docutils literal notranslate"><span class="pre">request</span></code>:</p>
<ol class="simple">
<li><p>Launch the node process like <code class="docutils literal notranslate"><span class="pre">NODE_DEBUG=request</span> <span class="pre">node</span> <span class="pre">script.js</span></code>
(<code class="docutils literal notranslate"><span class="pre">lib,request,otherlib</span></code> works too).</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">require('request').debug</span> <span class="pre">=</span> <span class="pre">true</span></code> at any time (this does the same thing
as #1).</p></li>
<li><p>Use the <a class="reference external" href="https://github.com/request/request-debug">request-debug module</a> to
view request and response headers and bodies.</p></li>
</ol>
<p><a class="reference external" href="#table-of-contents">back to top</a></p>
</div>
<hr class="docutils" />
<div class="section" id="timeouts">
<h2>Timeouts<a class="headerlink" href="#timeouts" title="Permalink to this headline">¶</a></h2>
<p>Most requests to external servers should have a timeout attached, in case the
server is not responding in a timely manner. Without a timeout, your code may
have a socket open/consume resources for minutes or more.</p>
<p>There are two main types of timeouts: <strong>connection timeouts</strong> and <strong>read
timeouts</strong>. A connect timeout occurs if the timeout is hit while your client is
attempting to establish a connection to a remote machine (corresponding to the
<a class="reference external" href="http://linux.die.net/man/2/connect">connect() call</a> on the socket). A read timeout occurs any time the
server is too slow to send back a part of the response.</p>
<p>These two situations have widely different implications for what went wrong
with the request, so it’s useful to be able to distinguish them. You can detect
timeout errors by checking <code class="docutils literal notranslate"><span class="pre">err.code</span></code> for an ‘ETIMEDOUT’ value. Further, you
can detect whether the timeout was a connection timeout by checking if the
<code class="docutils literal notranslate"><span class="pre">err.connect</span></code> property is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">request</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;http://10.255.255.1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">timeout</span><span class="o">:</span> <span class="mf">1500</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">code</span> <span class="o">===</span> <span class="s1">&#39;ETIMEDOUT&#39;</span><span class="p">);</span>
    <span class="c1">// Set to `true` if the timeout was a connection timeout, `false` or</span>
    <span class="c1">// `undefined` otherwise.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">connect</span> <span class="o">===</span> <span class="kc">true</span><span class="p">);</span>
    <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="examples">
<h2>Examples:<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span>  <span class="kd">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">rand</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="mf">100000000</span><span class="p">).</span><span class="nx">toString</span><span class="p">()</span>
    <span class="p">;</span>
  <span class="nx">request</span><span class="p">(</span>
    <span class="p">{</span> <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;PUT&#39;</span>
    <span class="p">,</span> <span class="nx">uri</span><span class="o">:</span> <span class="s1">&#39;http://mikeal.iriscouch.com/testjs/&#39;</span> <span class="o">+</span> <span class="nx">rand</span>
    <span class="p">,</span> <span class="nx">multipart</span><span class="o">:</span>
      <span class="p">[</span> <span class="p">{</span> <span class="s1">&#39;content-type&#39;</span><span class="o">:</span> <span class="s1">&#39;application/json&#39;</span>
        <span class="p">,</span>  <span class="nx">body</span><span class="o">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span><span class="nx">foo</span><span class="o">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="nx">_attachments</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;message.txt&#39;</span><span class="o">:</span> <span class="p">{</span><span class="nx">follows</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">length</span><span class="o">:</span> <span class="mf">18</span><span class="p">,</span> <span class="s1">&#39;content_type&#39;</span><span class="o">:</span> <span class="s1">&#39;text/plain&#39;</span> <span class="p">}}})</span>
        <span class="p">}</span>
      <span class="p">,</span> <span class="p">{</span> <span class="nx">body</span><span class="o">:</span> <span class="s1">&#39;I am an attachment&#39;</span> <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">==</span> <span class="mf">201</span><span class="p">){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;document saved as: http://mikeal.iriscouch.com/testjs/&#39;</span><span class="o">+</span> <span class="nx">rand</span><span class="p">)</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;error: &#39;</span><span class="o">+</span> <span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">)</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">)</span>
</pre></div>
</div>
<p>For backwards-compatibility, response compression is not supported by default.
To accept gzip-compressed responses, set the <code class="docutils literal notranslate"><span class="pre">gzip</span></code> option to <code class="docutils literal notranslate"><span class="pre">true</span></code>. Note
that the body data passed through <code class="docutils literal notranslate"><span class="pre">request</span></code> is automatically decompressed
while the response object is unmodified and will contain compressed data if
the server sent a compressed response.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span>  <span class="kd">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">)</span>
  <span class="nx">request</span><span class="p">(</span>
    <span class="p">{</span> <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;GET&#39;</span>
    <span class="p">,</span> <span class="nx">uri</span><span class="o">:</span> <span class="s1">&#39;http://www.google.com&#39;</span>
    <span class="p">,</span> <span class="nx">gzip</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// body is the decompressed response body</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;server encoded the data as: &#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="s1">&#39;content-encoding&#39;</span><span class="p">]</span> <span class="o">||</span> <span class="s1">&#39;identity&#39;</span><span class="p">))</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;the decoded data is: &#39;</span> <span class="o">+</span> <span class="nx">body</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">)</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// decompressed data as it is received</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;decoded chunk: &#39;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;response&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// unmodified http.IncomingMessage object</span>
    <span class="nx">response</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// compressed data as it is received</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;received &#39;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="s1">&#39; bytes of compressed data&#39;</span><span class="p">)</span>
    <span class="p">})</span>
  <span class="p">})</span>
</pre></div>
</div>
<p>Cookies are disabled by default (else, they would be used in subsequent requests). To enable cookies, set <code class="docutils literal notranslate"><span class="pre">jar</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code> (either in <code class="docutils literal notranslate"><span class="pre">defaults</span></code> or <code class="docutils literal notranslate"><span class="pre">options</span></code>).</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">defaults</span><span class="p">({</span><span class="nx">jar</span><span class="o">:</span> <span class="kc">true</span><span class="p">})</span>
<span class="nx">request</span><span class="p">(</span><span class="s1">&#39;http://www.google.com&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">request</span><span class="p">(</span><span class="s1">&#39;http://images.google.com&#39;</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
<p>To use a custom cookie jar (instead of <code class="docutils literal notranslate"><span class="pre">request</span></code>’s global cookie jar), set <code class="docutils literal notranslate"><span class="pre">jar</span></code> to an instance of <code class="docutils literal notranslate"><span class="pre">request.jar()</span></code> (either in <code class="docutils literal notranslate"><span class="pre">defaults</span></code> or <code class="docutils literal notranslate"><span class="pre">options</span></code>)</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span> <span class="nx">j</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">jar</span><span class="p">()</span>
<span class="kd">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">defaults</span><span class="p">({</span><span class="nx">jar</span><span class="o">:</span><span class="nx">j</span><span class="p">})</span>
<span class="nx">request</span><span class="p">(</span><span class="s1">&#39;http://www.google.com&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">request</span><span class="p">(</span><span class="s1">&#39;http://images.google.com&#39;</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
<p>OR</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span> <span class="nx">j</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">jar</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">cookie</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">cookie</span><span class="p">(</span><span class="s1">&#39;key1=value1&#39;</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s1">&#39;http://www.google.com&#39;</span><span class="p">;</span>
<span class="nx">j</span><span class="p">.</span><span class="nx">setCookie</span><span class="p">(</span><span class="nx">cookie</span><span class="p">,</span> <span class="nx">url</span><span class="p">);</span>
<span class="nx">request</span><span class="p">({</span><span class="nx">url</span><span class="o">:</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">jar</span><span class="o">:</span> <span class="nx">j</span><span class="p">},</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">request</span><span class="p">(</span><span class="s1">&#39;http://images.google.com&#39;</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
<p>To use a custom cookie store (such as a
<a class="reference external" href="https://github.com/mitsuru/tough-cookie-filestore"><code class="docutils literal notranslate"><span class="pre">FileCookieStore</span></code></a>
which supports saving to and restoring from JSON files), pass it as a parameter
to <code class="docutils literal notranslate"><span class="pre">request.jar()</span></code>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span> <span class="nx">FileCookieStore</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;tough-cookie-filestore&#39;</span><span class="p">);</span>
<span class="c1">// NOTE - currently the &#39;cookies.json&#39; file must already exist!</span>
<span class="kd">const</span> <span class="nx">j</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">jar</span><span class="p">(</span><span class="k">new</span> <span class="nx">FileCookieStore</span><span class="p">(</span><span class="s1">&#39;cookies.json&#39;</span><span class="p">));</span>
<span class="nx">request</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">defaults</span><span class="p">({</span> <span class="nx">jar</span> <span class="o">:</span> <span class="nx">j</span> <span class="p">})</span>
<span class="nx">request</span><span class="p">(</span><span class="s1">&#39;http://www.google.com&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">request</span><span class="p">(</span><span class="s1">&#39;http://images.google.com&#39;</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
<p>The cookie store must be a
<a class="reference external" href="https://github.com/SalesforceEng/tough-cookie"><code class="docutils literal notranslate"><span class="pre">tough-cookie</span></code></a>
store and it must support synchronous operations; see the
<a class="reference external" href="https://github.com/SalesforceEng/tough-cookie#api"><code class="docutils literal notranslate"><span class="pre">CookieStore</span></code> API docs</a>
for details.</p>
<p>To inspect your cookie jar after a request:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span> <span class="nx">j</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">jar</span><span class="p">()</span>
<span class="nx">request</span><span class="p">({</span><span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.google.com&#39;</span><span class="p">,</span> <span class="nx">jar</span><span class="o">:</span> <span class="nx">j</span><span class="p">},</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">cookie_string</span> <span class="o">=</span> <span class="nx">j</span><span class="p">.</span><span class="nx">getCookieString</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span> <span class="c1">// &quot;key1=value1; key2=value2; ...&quot;</span>
  <span class="kd">const</span> <span class="nx">cookies</span> <span class="o">=</span> <span class="nx">j</span><span class="p">.</span><span class="nx">getCookies</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
  <span class="c1">// [{key: &#39;key1&#39;, value: &#39;value1&#39;, domain: &quot;www.google.com&quot;, ...}, ...]</span>
<span class="p">})</span>
</pre></div>
</div>
<p><a class="reference external" href="#table-of-contents">back to top</a></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./nbs/z-repo_Solidity/Faucet/node_modules/request"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Dave Friedman<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>