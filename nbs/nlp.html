
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>&lt;no title&gt; &#8212; Mathematics</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Mathematics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../README.html">
   Mathematics
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Foundations
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Sets.html">
   Sets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ComplexNumbers.html">
   Complex Numbers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="NumberTheory.html">
   Number Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="AlgorithmicNumberTheory.html">
   Algorithmic Number Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ModularArithmetic.html">
   Modular Arithmetic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Polynomials.html">
   Polynomials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ConicSections.html">
   Conic Sections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Structures.html">
   Structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Groups.html">
   Groups
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Fields.html">
   Fields
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="LinearAlgebra.html">
   Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mathematical_foundations.html">
   Imports
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Modeling
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="RandomWalks.html">
   Random Walks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="DigitalSignalProcessing.html">
   Digital Signal Processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="DifferentialEquations.html">
   Differential Equations
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Blockchain
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="PythonBlockchain.html">
   Python Blockchain
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/nbs/nlp.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/davefriedman01/Resources"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/davefriedman01/Resources/issues/new?title=Issue%20on%20page%20%2Fnbs/nlp.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/davefriedman01/Resources/master?urlpath=tree/docs/nbs/nlp.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="simple visible nav section-nav flex-column">
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">find_dotenv</span><span class="p">,</span> <span class="n">get_key</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">mpl</span><span class="p">,</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-whitegrid&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span><span class="p">,</span> <span class="n">TfidfVectorizer</span>

<span class="kn">import</span> <span class="nn">alpaca_trade_api</span> <span class="k">as</span> <span class="nn">tradeapi</span>
<span class="n">alpaca_api_key</span> <span class="o">=</span> <span class="s1">&#39;PKKSFLVI3BMIRQBN6C2K&#39;</span>
<span class="n">alpaca_secret_key</span> <span class="o">=</span> <span class="s1">&#39;sW1fFZmq9HZwyL5p6OkFrJbr2TFq1H5IJ2njVLik&#39;</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">tradeapi</span><span class="o">.</span><span class="n">REST</span><span class="p">(</span><span class="n">alpaca_api_key</span><span class="p">,</span> <span class="n">alpaca_secret_key</span><span class="p">,</span> <span class="n">api_version</span><span class="o">=</span><span class="s1">&#39;v2&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">newsapi</span> <span class="kn">import</span> <span class="n">NewsApiClient</span>
<span class="c1">#from newsapi.newsapi_client import NewsApiClient</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s1">&#39;87dec3a300674a8a87b91a1da6ab30be&#39;</span>
<span class="n">newsapi</span> <span class="o">=</span> <span class="n">NewsApiClient</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="n">api_key</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">nltk</span>
<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">inaugural</span><span class="p">,</span> <span class="n">reuters</span><span class="p">,</span> <span class="n">stopwords</span>
<span class="c1">#stopwords.words(&#39;english&#39;)</span>
<span class="kn">from</span> <span class="nn">nltk.sentiment.vader</span> <span class="kn">import</span> <span class="n">SentimentIntensityAnalyzer</span>
<span class="kn">from</span> <span class="nn">nltk.stem</span> <span class="kn">import</span> <span class="n">WordNetLemmatizer</span>
<span class="kn">from</span> <span class="nn">nltk.tokenize</span> <span class="kn">import</span> <span class="n">sent_tokenize</span><span class="p">,</span> <span class="n">word_tokenize</span>
<span class="kn">from</span> <span class="nn">nltk.util</span> <span class="kn">import</span> <span class="n">ngrams</span>
<span class="kn">from</span> <span class="nn">wordcloud</span> <span class="kn">import</span> <span class="n">WordCloud</span>

<span class="kn">from</span> <span class="nn">ibm_watson</span> <span class="kn">import</span> <span class="n">ToneAnalyzerV3</span>
<span class="kn">from</span> <span class="nn">ibm_cloud_sdk_core.authenticators</span> <span class="kn">import</span> <span class="n">IAMAuthenticator</span>
<span class="n">tone_api</span> <span class="o">=</span> <span class="s1">&#39;0R866-tePJfMWni9gl454-jWDOS44kvX12Te4KZFe6Wr&#39;</span>
<span class="n">tone_url</span> <span class="o">=</span> <span class="s1">&#39;https://api.us-east.tone-analyzer.watson.cloud.ibm.com/instances/fc8d2c71-5116-43ab-8c9a-de4a584aa663&#39;</span>

<span class="kn">import</span> <span class="nn">spacy</span>
<span class="kn">from</span> <span class="nn">spacy</span> <span class="kn">import</span> <span class="n">displacy</span>
<span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;en_core_web_sm&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>NLP Natural Language Processing<br>
    
Preprocessing<br>
        
Tokenization<br>
        
Lemmatization<br>
        
Stopwording<br>
    
Extraction<br>
    
Analysis<br>
    
Representation<br></p>
<p>Frequency Analysis<br>
Counting tokens<br>
Ngram<br>
Word Cloud<br></p>
<p>Text Modeling<br>
Sentiment Analysis<br>
Tone Analysis<br></p>
<p><a class="reference external" href="https://docs.python.org/3/library/re.html">https://docs.python.org/3/library/re.html</a><br>
<a class="reference external" href="https://spacy.io/api/data-formats">https://spacy.io/api/data-formats</a><br>
<a class="reference external" href="https://spacy.io/api/data-formats#pos-tagging">https://spacy.io/api/data-formats#pos-tagging</a><br></p>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reuters</span><span class="o">.</span><span class="n">categories</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;acq&#39;,
 &#39;alum&#39;,
 &#39;barley&#39;,
 &#39;bop&#39;,
 &#39;carcass&#39;,
 &#39;castor-oil&#39;,
 &#39;cocoa&#39;,
 &#39;coconut&#39;,
 &#39;coconut-oil&#39;,
 &#39;coffee&#39;,
 &#39;copper&#39;,
 &#39;copra-cake&#39;,
 &#39;corn&#39;,
 &#39;cotton&#39;,
 &#39;cotton-oil&#39;,
 &#39;cpi&#39;,
 &#39;cpu&#39;,
 &#39;crude&#39;,
 &#39;dfl&#39;,
 &#39;dlr&#39;,
 &#39;dmk&#39;,
 &#39;earn&#39;,
 &#39;fuel&#39;,
 &#39;gas&#39;,
 &#39;gnp&#39;,
 &#39;gold&#39;,
 &#39;grain&#39;,
 &#39;groundnut&#39;,
 &#39;groundnut-oil&#39;,
 &#39;heat&#39;,
 &#39;hog&#39;,
 &#39;housing&#39;,
 &#39;income&#39;,
 &#39;instal-debt&#39;,
 &#39;interest&#39;,
 &#39;ipi&#39;,
 &#39;iron-steel&#39;,
 &#39;jet&#39;,
 &#39;jobs&#39;,
 &#39;l-cattle&#39;,
 &#39;lead&#39;,
 &#39;lei&#39;,
 &#39;lin-oil&#39;,
 &#39;livestock&#39;,
 &#39;lumber&#39;,
 &#39;meal-feed&#39;,
 &#39;money-fx&#39;,
 &#39;money-supply&#39;,
 &#39;naphtha&#39;,
 &#39;nat-gas&#39;,
 &#39;nickel&#39;,
 &#39;nkr&#39;,
 &#39;nzdlr&#39;,
 &#39;oat&#39;,
 &#39;oilseed&#39;,
 &#39;orange&#39;,
 &#39;palladium&#39;,
 &#39;palm-oil&#39;,
 &#39;palmkernel&#39;,
 &#39;pet-chem&#39;,
 &#39;platinum&#39;,
 &#39;potato&#39;,
 &#39;propane&#39;,
 &#39;rand&#39;,
 &#39;rape-oil&#39;,
 &#39;rapeseed&#39;,
 &#39;reserves&#39;,
 &#39;retail&#39;,
 &#39;rice&#39;,
 &#39;rubber&#39;,
 &#39;rye&#39;,
 &#39;ship&#39;,
 &#39;silver&#39;,
 &#39;sorghum&#39;,
 &#39;soy-meal&#39;,
 &#39;soy-oil&#39;,
 &#39;soybean&#39;,
 &#39;strategic-metal&#39;,
 &#39;sugar&#39;,
 &#39;sun-meal&#39;,
 &#39;sun-oil&#39;,
 &#39;sunseed&#39;,
 &#39;tea&#39;,
 &#39;tin&#39;,
 &#39;trade&#39;,
 &#39;veg-oil&#39;,
 &#39;wheat&#39;,
 &#39;wpi&#39;,
 &#39;yen&#39;,
 &#39;zinc&#39;]
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">process_text</span> <span class="p">(</span><span class="n">article</span><span class="p">):</span>
    <span class="n">sw</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">))</span>
    <span class="n">sw_addons</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;said&#39;</span><span class="p">,</span> <span class="s1">&#39;sent&#39;</span><span class="p">,</span> <span class="s1">&#39;found&#39;</span><span class="p">,</span> <span class="s1">&#39;including&#39;</span><span class="p">,</span> <span class="s1">&#39;today&#39;</span><span class="p">,</span> <span class="s1">&#39;announced&#39;</span><span class="p">,</span> <span class="s1">&#39;week&#39;</span><span class="p">,</span> <span class="s1">&#39;basically&#39;</span><span class="p">,</span> <span class="s1">&#39;also&#39;</span><span class="p">}</span>
    <span class="n">regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;[^a-zA-Z ]&#39;</span><span class="p">)</span>
    <span class="n">re_clean</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">article</span><span class="p">)</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">word_tokenize</span><span class="p">(</span><span class="n">re_clean</span><span class="p">)</span>
    <span class="n">lemmatizer</span> <span class="o">=</span> <span class="n">WordNetLemmatizer</span><span class="p">()</span>
    <span class="n">lem</span> <span class="o">=</span> <span class="p">[</span><span class="n">lemmatizer</span><span class="o">.</span><span class="n">lemmatize</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">]</span>
    <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">lem</span> <span class="k">if</span> <span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sw</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">sw_addons</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">output</span>
<span class="k">def</span> <span class="nf">process_text_bg</span> <span class="p">(</span><span class="n">doc</span><span class="p">):</span>
    <span class="n">sw_words</span> <span class="o">=</span> <span class="n">process_text</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
    <span class="n">bigrams</span> <span class="o">=</span> <span class="n">ngrams</span><span class="p">(</span><span class="n">sw_words</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">bigrams</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">output</span>
<span class="k">def</span> <span class="nf">word_counter</span> <span class="p">(</span><span class="n">corpus</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Combine all articles in corpus into one large string. &#39;&#39;&#39;</span>
    <span class="n">big_string</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>
    <span class="n">processed</span> <span class="o">=</span> <span class="n">process_text</span><span class="p">(</span><span class="n">big_string</span><span class="p">)</span>
    <span class="n">top_10</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">processed</span><span class="p">)</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">top_10</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;word&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">bigram_counter</span> <span class="p">(</span><span class="n">corpus</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Combine all articles in corpus into one large string. &#39;&#39;&#39;</span>
    <span class="n">big_string</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>
    <span class="n">processed</span> <span class="o">=</span> <span class="n">process_text</span><span class="p">(</span><span class="n">big_string</span><span class="p">)</span>
    <span class="n">bigrams</span> <span class="o">=</span> <span class="n">ngrams</span><span class="p">(</span><span class="n">processed</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">top_10</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">bigrams</span><span class="p">)</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">top_10</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bigram&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ids</span> <span class="o">=</span> <span class="n">reuters</span><span class="o">.</span><span class="n">fileids</span><span class="p">(</span><span class="n">categories</span><span class="o">=</span><span class="s1">&#39;gas&#39;</span><span class="p">)</span>
<span class="n">corpus</span> <span class="o">=</span> <span class="p">[</span><span class="n">reuters</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span>
    <span class="n">word_counter</span><span class="p">(</span><span class="n">corpus</span><span class="p">),</span>
    <span class="n">bigram_counter</span><span class="p">(</span><span class="n">corpus</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">sentence_tokenized</span> <span class="o">=</span> <span class="p">[</span><span class="n">sent_tokenize</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">corpus</span><span class="p">]</span>

<span class="n">word_tokenized</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">story</span> <span class="ow">in</span> <span class="n">sentence_tokenized</span><span class="p">:</span>
    <span class="n">words</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">story</span><span class="p">:</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">words</span> <span class="o">+</span> <span class="n">word_tokenize</span><span class="p">(</span><span class="n">sent</span><span class="p">)</span>
    <span class="n">word_tokenized</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>

<span class="n">reuters_cpi</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;articles&#39;</span><span class="p">:</span> <span class="n">corpus</span><span class="p">,</span>
                            <span class="s1">&#39;sentence_tokenized&#39;</span><span class="p">:</span> <span class="n">sentence_tokenized</span><span class="p">,</span>
                            <span class="s1">&#39;word_tokenized&#39;</span><span class="p">:</span> <span class="n">word_tokenized</span><span class="p">})</span>
<span class="n">reuters_cpi</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">ids</span>
<span class="n">reuters_cpi</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>word</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mln</td>
      <td>214</td>
    </tr>
    <tr>
      <th>1</th>
      <td>pct</td>
      <td>135</td>
    </tr>
    <tr>
      <th>2</th>
      <td>gasoline</td>
      <td>113</td>
    </tr>
    <tr>
      <th>3</th>
      <td>oil</td>
      <td>101</td>
    </tr>
    <tr>
      <th>4</th>
      <td>crude</td>
      <td>72</td>
    </tr>
    <tr>
      <th>5</th>
      <td>year</td>
      <td>70</td>
    </tr>
    <tr>
      <th>6</th>
      <td>barrel</td>
      <td>70</td>
    </tr>
    <tr>
      <th>7</th>
      <td>price</td>
      <td>68</td>
    </tr>
    <tr>
      <th>8</th>
      <td>bpd</td>
      <td>56</td>
    </tr>
    <tr>
      <th>9</th>
      <td>would</td>
      <td>48</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bigram</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(mln, barrel)</td>
      <td>53</td>
    </tr>
    <tr>
      <th>1</th>
      <td>(mln, bpd)</td>
      <td>47</td>
    </tr>
    <tr>
      <th>2</th>
      <td>(pct, mln)</td>
      <td>33</td>
    </tr>
    <tr>
      <th>3</th>
      <td>(bpd, pct)</td>
      <td>29</td>
    </tr>
    <tr>
      <th>4</th>
      <td>(crude, oil)</td>
      <td>22</td>
    </tr>
    <tr>
      <th>5</th>
      <td>(mln, eia)</td>
      <td>20</td>
    </tr>
    <tr>
      <th>6</th>
      <td>(year, ago)</td>
      <td>20</td>
    </tr>
    <tr>
      <th>7</th>
      <td>(rose, pct)</td>
      <td>19</td>
    </tr>
    <tr>
      <th>8</th>
      <td>(crude, mln)</td>
      <td>18</td>
    </tr>
    <tr>
      <th>9</th>
      <td>(says, distillate)</td>
      <td>17</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>articles</th>
      <th>sentence_tokenized</th>
      <th>word_tokenized</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>test/14863</th>
      <td>FINNS AND CANADIANS TO STUDY MTBE PRODUCTION P...</td>
      <td>[FINNS AND CANADIANS TO STUDY MTBE PRODUCTION ...</td>
      <td>[FINNS, AND, CANADIANS, TO, STUDY, MTBE, PRODU...</td>
    </tr>
    <tr>
      <th>test/15339</th>
      <td>EIA SAYS DISTILLATE STOCKS UNCHANGED, GASOLINE...</td>
      <td>[EIA SAYS DISTILLATE STOCKS UNCHANGED, GASOLIN...</td>
      <td>[EIA, SAYS, DISTILLATE, STOCKS, UNCHANGED, ,, ...</td>
    </tr>
    <tr>
      <th>test/15344</th>
      <td>EIA SAYS DISTILLATE STOCKS UNCHANGED IN WEEK\n...</td>
      <td>[EIA SAYS DISTILLATE STOCKS UNCHANGED IN WEEK\...</td>
      <td>[EIA, SAYS, DISTILLATE, STOCKS, UNCHANGED, IN,...</td>
    </tr>
    <tr>
      <th>test/15351</th>
      <td>RECENT U.S. OIL DEMAND OFF 2.6 PCT FROM YEAR A...</td>
      <td>[RECENT U.S. OIL DEMAND OFF 2.6 PCT FROM YEAR ...</td>
      <td>[RECENT, U.S., OIL, DEMAND, OFF, 2.6, PCT, FRO...</td>
    </tr>
    <tr>
      <th>test/16581</th>
      <td>EXXON &amp;lt;XON&gt; EXTENDS MID-GRADE UNLEADED MARK...</td>
      <td>[EXXON &amp;lt;XON&gt; EXTENDS MID-GRADE UNLEADED MAR...</td>
      <td>[EXXON, &amp;, lt, ;, XON, &gt;, EXTENDS, MID-GRADE, ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wc</span> <span class="o">=</span> <span class="n">WordCloud</span><span class="p">(</span><span class="n">background_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">process_text</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">corpus</span><span class="p">))))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">));</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">wc</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/nlp_8_0.png" src="../_images/nlp_8_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">));</span>
<span class="n">wc</span> <span class="o">=</span> <span class="n">WordCloud</span><span class="p">(</span><span class="n">background_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">process_text_bg</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">corpus</span><span class="p">))))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">wc</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/nlp_9_0.png" src="../_images/nlp_9_0.png" />
</div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">authenticator</span> <span class="o">=</span> <span class="n">IAMAuthenticator</span><span class="p">(</span><span class="n">tone_api</span><span class="p">)</span>
<span class="n">tone_analyzer</span> <span class="o">=</span> <span class="n">ToneAnalyzerV3</span><span class="p">(</span>
    <span class="n">version</span><span class="o">=</span><span class="s1">&#39;2017-09-21&#39;</span><span class="p">,</span>
    <span class="n">authenticator</span><span class="o">=</span><span class="n">authenticator</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">tone_analyzer</span><span class="o">.</span><span class="n">set_service_url</span><span class="p">(</span><span class="n">tone_url</span><span class="p">)</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Team, I know that times are tough!</span>
<span class="s2">Product sales have been disappointing for the past three quarters.</span>
<span class="s2">We have a competitive product, but we need to do a better job of selling it!</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">tone_analysis</span> <span class="o">=</span> <span class="n">tone_analyzer</span><span class="o">.</span><span class="n">tone</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">text</span><span class="p">},</span>
    <span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
    <span class="n">content_language</span><span class="o">=</span><span class="s1">&#39;en&#39;</span><span class="p">,</span>
    <span class="n">accept_language</span><span class="o">=</span><span class="s1">&#39;en&#39;</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">get_result</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">tone_analysis</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

<span class="n">doc_tone_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">tone_analysis</span><span class="p">[</span><span class="s1">&#39;document_tone&#39;</span><span class="p">],</span> <span class="n">record_path</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tones&#39;</span><span class="p">])</span>
<span class="n">doc_tone_df</span>

<span class="n">sentences_tone_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">tone_analysis</span><span class="p">[</span><span class="s1">&#39;sentences_tone&#39;</span><span class="p">],</span>
    <span class="n">record_path</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tones&#39;</span><span class="p">],</span>
    <span class="n">meta</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sentence_id&#39;</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">sentences_tone_df</span>

<span class="n">utterances</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello, I&#39;m having a problem with your product.&quot;</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;customer&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;OK, let me know what&#39;s going on, please.&quot;</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;agent&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Well, nothing is working :(&quot;</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;customer&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Sorry to hear that.&quot;</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;agent&quot;</span><span class="p">},</span>
<span class="p">]</span>
<span class="n">utterance_analysis</span> <span class="o">=</span> <span class="n">tone_analyzer</span><span class="o">.</span><span class="n">tone_chat</span><span class="p">(</span>
    <span class="n">utterances</span><span class="o">=</span><span class="n">utterances</span><span class="p">,</span> <span class="n">content_language</span><span class="o">=</span><span class="s1">&#39;en&#39;</span><span class="p">,</span> <span class="n">accept_language</span><span class="o">=</span><span class="s1">&#39;en&#39;</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">get_result</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">utterance_analysis</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

<span class="n">chat_tone_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">utterance_analysis</span><span class="p">[</span><span class="s1">&#39;utterances_tone&#39;</span><span class="p">],</span>
    <span class="n">record_path</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tones&#39;</span><span class="p">],</span>
    <span class="n">meta</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;utterance_id&#39;</span><span class="p">,</span> <span class="s1">&#39;utterance_text&#39;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">chat_tone_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{
  &quot;document_tone&quot;: {
    &quot;tones&quot;: [
      {
        &quot;score&quot;: 0.6165,
        &quot;tone_id&quot;: &quot;sadness&quot;,
        &quot;tone_name&quot;: &quot;Sadness&quot;
      },
      {
        &quot;score&quot;: 0.829888,
        &quot;tone_id&quot;: &quot;analytical&quot;,
        &quot;tone_name&quot;: &quot;Analytical&quot;
      }
    ]
  },
  &quot;sentences_tone&quot;: [
    {
      &quot;sentence_id&quot;: 0,
      &quot;text&quot;: &quot;Team, I know that times are tough!&quot;,
      &quot;tones&quot;: [
        {
          &quot;score&quot;: 0.801827,
          &quot;tone_id&quot;: &quot;analytical&quot;,
          &quot;tone_name&quot;: &quot;Analytical&quot;
        }
      ]
    },
    {
      &quot;sentence_id&quot;: 1,
      &quot;text&quot;: &quot;Product sales have been disappointing for the past three quarters.&quot;,
      &quot;tones&quot;: [
        {
          &quot;score&quot;: 0.771241,
          &quot;tone_id&quot;: &quot;sadness&quot;,
          &quot;tone_name&quot;: &quot;Sadness&quot;
        },
        {
          &quot;score&quot;: 0.687768,
          &quot;tone_id&quot;: &quot;analytical&quot;,
          &quot;tone_name&quot;: &quot;Analytical&quot;
        }
      ]
    },
    {
      &quot;sentence_id&quot;: 2,
      &quot;text&quot;: &quot;We have a competitive product, but we need to do a better job of selling it!&quot;,
      &quot;tones&quot;: [
        {
          &quot;score&quot;: 0.506763,
          &quot;tone_id&quot;: &quot;analytical&quot;,
          &quot;tone_name&quot;: &quot;Analytical&quot;
        }
      ]
    }
  ]
}
{
  &quot;utterances_tone&quot;: [
    {
      &quot;utterance_id&quot;: 0,
      &quot;utterance_text&quot;: &quot;Hello, I&#39;m having a problem with your product.&quot;,
      &quot;tones&quot;: [
        {
          &quot;score&quot;: 0.686361,
          &quot;tone_id&quot;: &quot;polite&quot;,
          &quot;tone_name&quot;: &quot;Polite&quot;
        }
      ]
    },
    {
      &quot;utterance_id&quot;: 1,
      &quot;utterance_text&quot;: &quot;OK, let me know what&#39;s going on, please.&quot;,
      &quot;tones&quot;: [
        {
          &quot;score&quot;: 0.92724,
          &quot;tone_id&quot;: &quot;polite&quot;,
          &quot;tone_name&quot;: &quot;Polite&quot;
        }
      ]
    },
    {
      &quot;utterance_id&quot;: 2,
      &quot;utterance_text&quot;: &quot;Well, nothing is working :(&quot;,
      &quot;tones&quot;: [
        {
          &quot;score&quot;: 0.997795,
          &quot;tone_id&quot;: &quot;sad&quot;,
          &quot;tone_name&quot;: &quot;Sad&quot;
        }
      ]
    },
    {
      &quot;utterance_id&quot;: 3,
      &quot;utterance_text&quot;: &quot;Sorry to hear that.&quot;,
      &quot;tones&quot;: [
        {
          &quot;score&quot;: 0.730982,
          &quot;tone_id&quot;: &quot;polite&quot;,
          &quot;tone_name&quot;: &quot;Polite&quot;
        },
        {
          &quot;score&quot;: 0.672499,
          &quot;tone_id&quot;: &quot;sympathetic&quot;,
          &quot;tone_name&quot;: &quot;Sympathetic&quot;
        }
      ]
    }
  ]
}
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>score</th>
      <th>tone_id</th>
      <th>tone_name</th>
      <th>utterance_id</th>
      <th>utterance_text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.686361</td>
      <td>polite</td>
      <td>Polite</td>
      <td>0</td>
      <td>Hello, I'm having a problem with your product.</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.927240</td>
      <td>polite</td>
      <td>Polite</td>
      <td>1</td>
      <td>OK, let me know what's going on, please.</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.997795</td>
      <td>sad</td>
      <td>Sad</td>
      <td>2</td>
      <td>Well, nothing is working :(</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.730982</td>
      <td>polite</td>
      <td>Polite</td>
      <td>3</td>
      <td>Sorry to hear that.</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.672499</td>
      <td>sympathetic</td>
      <td>Sympathetic</td>
      <td>3</td>
      <td>Sorry to hear that.</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">retrieve_docs</span> <span class="p">(</span><span class="n">terms</span><span class="p">):</span>
    <span class="n">result_docs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">doc_id</span> <span class="ow">in</span> <span class="n">money_news_ids</span><span class="p">:</span>
        <span class="n">found_terms</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">word</span>
            <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">reuters</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="n">doc_id</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">term</span> <span class="ow">in</span> <span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">found_terms</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">result_docs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">doc_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result_docs</span>

<span class="k">def</span> <span class="nf">create_df</span> <span class="p">(</span><span class="n">news</span><span class="p">,</span> <span class="n">language</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms the articles into a DataFrame.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    news [list]: the list of articles</span>
<span class="sd">    language [string]: specifies the language of the articles</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">articles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">article</span> <span class="ow">in</span> <span class="n">news</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">article</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
            <span class="n">description</span> <span class="o">=</span> <span class="n">article</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">article</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span>
            <span class="n">date</span> <span class="o">=</span> <span class="n">article</span><span class="p">[</span><span class="s1">&#39;publishedAt&#39;</span><span class="p">][:</span><span class="mi">10</span><span class="p">]</span>
            <span class="n">articles</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span>
                <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">text</span><span class="p">,</span>
                <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">,</span>
                <span class="s1">&#39;language&#39;</span><span class="p">:</span> <span class="n">language</span><span class="p">,</span>
            <span class="p">})</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">articles</span><span class="p">)</span>

<span class="n">crisis_news_en</span> <span class="o">=</span> <span class="n">newsapi</span><span class="o">.</span><span class="n">get_everything</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="s1">&#39;financial crisis 2008&#39;</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;en&#39;</span><span class="p">)</span>
<span class="n">crisis_news_en</span><span class="p">[</span><span class="s1">&#39;totalResults&#39;</span><span class="p">]</span>

<span class="n">crisis_news_fr</span> <span class="o">=</span> <span class="n">newsapi</span><span class="o">.</span><span class="n">get_everything</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="s1">&#39;financière crise 2008&#39;</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;fr&#39;</span><span class="p">)</span>
<span class="n">crisis_news_fr</span><span class="p">[</span><span class="s1">&#39;totalResults&#39;</span><span class="p">]</span>

<span class="n">crisis_en_df</span> <span class="o">=</span> <span class="n">create_df</span><span class="p">(</span><span class="n">crisis_news_en</span><span class="p">[</span><span class="s1">&#39;articles&#39;</span><span class="p">],</span> <span class="s1">&#39;en&#39;</span><span class="p">)</span>
<span class="n">crisis_fr_df</span> <span class="o">=</span> <span class="n">create_df</span><span class="p">(</span><span class="n">crisis_news_fr</span><span class="p">[</span><span class="s1">&#39;articles&#39;</span><span class="p">],</span> <span class="s1">&#39;fr&#39;</span><span class="p">)</span>
<span class="n">crisis_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">crisis_en_df</span><span class="p">,</span> <span class="n">crisis_fr_df</span><span class="p">])</span>
<span class="n">crisis_df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>

<span class="n">crisis_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;./crisis_news_en_fr.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8-sig&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">analyzer</span> <span class="o">=</span> <span class="n">SentimentIntensityAnalyzer</span><span class="p">()</span>
<span class="n">libra_headlines</span> <span class="o">=</span> <span class="n">newsapi</span><span class="o">.</span><span class="n">get_everything</span><span class="p">(</span>
    <span class="n">q</span><span class="o">=</span><span class="s1">&#39;facebook libra&#39;</span><span class="p">,</span>
    <span class="n">language</span><span class="o">=</span><span class="s1">&#39;en&#39;</span><span class="p">,</span>
    <span class="n">page_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">sort_by</span><span class="o">=</span><span class="s1">&#39;relevancy&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">libra_sentiments</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">article</span> <span class="ow">in</span> <span class="n">libra_headlines</span><span class="p">[</span><span class="s1">&#39;articles&#39;</span><span class="p">]:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">article</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span>
        <span class="n">date</span> <span class="o">=</span> <span class="n">article</span><span class="p">[</span><span class="s1">&#39;publishedAt&#39;</span><span class="p">][:</span><span class="mi">10</span><span class="p">]</span>
        <span class="n">sentiment</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">polarity_scores</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">compound</span> <span class="o">=</span> <span class="n">sentiment</span><span class="p">[</span><span class="s1">&#39;compound&#39;</span><span class="p">]</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">sentiment</span><span class="p">[</span><span class="s1">&#39;pos&#39;</span><span class="p">]</span>
        <span class="n">neu</span> <span class="o">=</span> <span class="n">sentiment</span><span class="p">[</span><span class="s1">&#39;neu&#39;</span><span class="p">]</span>
        <span class="n">neg</span> <span class="o">=</span> <span class="n">sentiment</span><span class="p">[</span><span class="s1">&#39;neg&#39;</span><span class="p">]</span>
        <span class="n">libra_sentiments</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">text</span><span class="p">,</span>
            <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">,</span>
            <span class="s1">&#39;compound&#39;</span><span class="p">:</span> <span class="n">compound</span><span class="p">,</span>
            <span class="s1">&#39;positive&#39;</span><span class="p">:</span> <span class="n">pos</span><span class="p">,</span>
            <span class="s1">&#39;negative&#39;</span><span class="p">:</span> <span class="n">neg</span><span class="p">,</span>
            <span class="s1">&#39;neutral&#39;</span><span class="p">:</span> <span class="n">neu</span><span class="p">,</span>
        <span class="p">})</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">pass</span>
<span class="n">libra_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">libra_sentiments</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="s1">&#39;compound&#39;</span><span class="p">,</span> <span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral&#39;</span><span class="p">]</span>
<span class="n">libra_df</span> <span class="o">=</span> <span class="n">libra_df</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>
<span class="n">libra_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>text</th>
      <th>compound</th>
      <th>positive</th>
      <th>negative</th>
      <th>neutral</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-06-23</td>
      <td>LONDON, June 23 (Reuters) - The Bank for Inter...</td>
      <td>0.0258</td>
      <td>0.034</td>
      <td>0.000</td>
      <td>0.966</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-06-23</td>
      <td>LONDON, June 23 (Reuters) - The Bank for Inter...</td>
      <td>0.0258</td>
      <td>0.034</td>
      <td>0.000</td>
      <td>0.966</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-06-07</td>
      <td>The rise of digital currencies could lead to a...</td>
      <td>-0.5267</td>
      <td>0.000</td>
      <td>0.124</td>
      <td>0.876</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-06-25</td>
      <td>Employees use an iPhone to demonstrate the App...</td>
      <td>-0.1027</td>
      <td>0.000</td>
      <td>0.045</td>
      <td>0.955</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-06-23</td>
      <td>(Kitco News) The Bank for International Settle...</td>
      <td>0.4019</td>
      <td>0.074</td>
      <td>0.000</td>
      <td>0.926</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;money-fx&#39;</span><span class="p">,</span> <span class="s1">&#39;money-supply&#39;</span><span class="p">]</span>
<span class="n">all_docs_id</span> <span class="o">=</span> <span class="n">reuters</span><span class="o">.</span><span class="n">fileids</span><span class="p">()</span>
<span class="n">money_news_ids</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">doc</span>
    <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">all_docs_id</span>
    <span class="k">if</span> <span class="n">categories</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">reuters</span><span class="o">.</span><span class="n">categories</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
    <span class="ow">or</span> <span class="n">categories</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">reuters</span><span class="o">.</span><span class="n">categories</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
<span class="p">]</span>
<span class="n">money_news</span> <span class="o">=</span> <span class="p">[</span><span class="n">reuters</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">money_news_ids</span><span class="p">]</span>

<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">stop_words</span><span class="o">=</span><span class="s1">&#39;english&#39;</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">money_news</span><span class="p">)</span>
<span class="n">money_news_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)))),</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Word&#39;</span><span class="p">,</span> <span class="s1">&#39;Frequency&#39;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">money_news_df</span> <span class="o">=</span> <span class="n">money_news_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">money_news_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="n">top_words</span> <span class="o">=</span> <span class="n">money_news_df</span><span class="p">[(</span><span class="n">money_news_df</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">money_news_df</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">30</span><span class="p">)]</span>
<span class="n">top_words</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="n">terms_list</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">top_words</span><span class="p">[</span><span class="s1">&#39;Word&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="n">wordcloud</span> <span class="o">=</span> <span class="n">WordCloud</span><span class="p">(</span><span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;RdYlBu&#39;</span><span class="p">,</span> <span class="n">background_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">terms_list</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">wordcloud</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Money News Word Cloud&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;fontweight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">});</span>

<span class="nb">len</span><span class="p">(</span><span class="n">retrieve_docs</span><span class="p">([</span><span class="s1">&#39;yen&#39;</span><span class="p">]))</span>
<span class="nb">len</span><span class="p">(</span><span class="n">retrieve_docs</span><span class="p">([</span><span class="s1">&#39;japan&#39;</span><span class="p">,</span> <span class="s1">&#39;banks&#39;</span><span class="p">]))</span>
<span class="nb">len</span><span class="p">(</span><span class="n">retrieve_docs</span><span class="p">([</span><span class="s1">&#39;england&#39;</span><span class="p">,</span> <span class="s1">&#39;dealers&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>299
</pre></div>
</div>
<img alt="../_images/nlp_17_1.png" src="../_images/nlp_17_1.png" />
</div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">doc_ids</span> <span class="o">=</span> <span class="n">reuters</span><span class="o">.</span><span class="n">fileids</span><span class="p">()</span>
<span class="nb">len</span><span class="p">(</span><span class="n">doc_ids</span><span class="p">)</span>

<span class="n">doc_id</span> <span class="o">=</span> <span class="s1">&#39;test/15045&#39;</span>
<span class="n">doc_text</span> <span class="o">=</span> <span class="n">reuters</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="n">doc_id</span><span class="p">)</span>
<span class="n">doc_text</span>

<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">stop_words</span><span class="o">=</span><span class="s1">&#39;english&#39;</span><span class="p">)</span>
<span class="n">vectorizer</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">([</span><span class="n">doc_text</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">words</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">()</span>
<span class="n">words</span>

<span class="n">words_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)))),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Word&#39;</span><span class="p">,</span> <span class="s1">&#39;Word_Count&#39;</span><span class="p">])</span>
<span class="n">words_df</span>



<span class="n">all_docs_id</span> <span class="o">=</span> <span class="n">reuters</span><span class="o">.</span><span class="n">fileids</span><span class="p">()</span>
<span class="n">corpus_id</span> <span class="o">=</span> <span class="n">all_docs_id</span><span class="p">[:</span><span class="mi">1000</span><span class="p">]</span>
<span class="n">corpus</span> <span class="o">=</span> <span class="p">[</span><span class="n">reuters</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">corpus_id</span><span class="p">]</span>
<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">stop_words</span><span class="o">=</span><span class="s1">&#39;english&#39;</span><span class="p">)</span>
<span class="n">X_corpus</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>
<span class="n">words_corpus</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">()</span>
<span class="n">words_corpus_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">words_corpus</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">X_corpus</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)))),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Word&#39;</span><span class="p">,</span> <span class="s1">&#39;TF-IDF&#39;</span><span class="p">])</span>
<span class="n">words_corpus_df</span> <span class="o">=</span> <span class="n">words_corpus_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TF-IDF&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">words_corpus_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  (0, 32)	2
  (0, 23)	3
  (0, 61)	3
  (0, 48)	1
  (0, 44)	8
  (0, 52)	1
  (0, 49)	3
  (0, 46)	4
  (0, 34)	7
  (0, 59)	3
  (0, 17)	1
  (0, 0)	3
  (0, 15)	1
  (0, 14)	1
  (0, 36)	1
  (0, 20)	1
  (0, 1)	2
  (0, 3)	3
  (0, 55)	1
  (0, 24)	1
  (0, 45)	2
  (0, 39)	2
  (0, 38)	4
  (0, 43)	1
  (0, 42)	1
  :	:
  (0, 56)	1
  (0, 50)	2
  (0, 53)	1
  (0, 54)	1
  (0, 62)	1
  (0, 51)	1
  (0, 30)	1
  (0, 58)	1
  (0, 47)	1
  (0, 28)	1
  (0, 64)	1
  (0, 31)	1
  (0, 66)	1
  (0, 27)	1
  (0, 41)	1
  (0, 35)	1
  (0, 40)	1
  (0, 57)	1
  (0, 63)	1
  (0, 25)	1
  (0, 22)	1
  (0, 7)	1
  (0, 9)	1
  (0, 8)	1
  (0, 21)	1
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Word</th>
      <th>TF-IDF</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9199</th>
      <td>vs</td>
      <td>0.079701</td>
    </tr>
    <tr>
      <th>5885</th>
      <td>mln</td>
      <td>0.061460</td>
    </tr>
    <tr>
      <th>2971</th>
      <td>cts</td>
      <td>0.051221</td>
    </tr>
    <tr>
      <th>1</th>
      <td>000</td>
      <td>0.047185</td>
    </tr>
    <tr>
      <th>7680</th>
      <td>said</td>
      <td>0.045466</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>402</th>
      <td>302</td>
      <td>0.000005</td>
    </tr>
    <tr>
      <th>1024</th>
      <td>893</td>
      <td>0.000005</td>
    </tr>
    <tr>
      <th>1053</th>
      <td>927</td>
      <td>0.000005</td>
    </tr>
    <tr>
      <th>71</th>
      <td>076</td>
      <td>0.000005</td>
    </tr>
    <tr>
      <th>7600</th>
      <td>rolled</td>
      <td>0.000005</td>
    </tr>
  </tbody>
</table>
<p>9489 rows × 2 columns</p>
</div></div></div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_headlines</span> <span class="p">(</span><span class="n">keyword</span><span class="p">):</span>
    <span class="n">all_headlines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">all_dates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">current_date</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">end_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">past_date</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Fetching news about </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">keyword</span><span class="si">}</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*&#39;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">date</span> <span class="o">&gt;</span> <span class="n">end_date</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;retrieving news from: </span><span class="si">{</span><span class="n">date</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">articles</span> <span class="o">=</span> <span class="n">newsapi</span><span class="o">.</span><span class="n">get_everything</span><span class="p">(</span>
            <span class="n">q</span><span class="o">=</span><span class="n">keyword</span><span class="p">,</span>
            <span class="n">from_param</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)[:</span><span class="mi">10</span><span class="p">],</span>
            <span class="n">to</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)[:</span><span class="mi">10</span><span class="p">],</span>
            <span class="n">language</span><span class="o">=</span><span class="s1">&#39;en&#39;</span><span class="p">,</span>
            <span class="n">sort_by</span><span class="o">=</span><span class="s1">&#39;relevancy&#39;</span><span class="p">,</span>
            <span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">headlines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">articles</span><span class="p">[</span><span class="s1">&#39;articles&#39;</span><span class="p">])):</span>
            <span class="n">headlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">articles</span><span class="p">[</span><span class="s1">&#39;articles&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
        <span class="n">all_headlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">headlines</span><span class="p">)</span>
        <span class="n">all_dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
        <span class="n">date</span> <span class="o">=</span> <span class="n">date</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">all_headlines</span><span class="p">,</span> <span class="n">all_dates</span>

<span class="k">def</span> <span class="nf">headline_sentiment_summarizer_avg</span> <span class="p">(</span><span class="n">headlines</span><span class="p">):</span>
    <span class="n">sentiment</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="n">headlines</span><span class="p">:</span>
        <span class="n">day_score</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">day</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">h</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">day_score</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sid</span><span class="o">.</span><span class="n">polarity_scores</span><span class="p">(</span><span class="n">h</span><span class="p">)[</span><span class="s1">&#39;compound&#39;</span><span class="p">])</span>
        <span class="n">sentiment</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">day_score</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">day_score</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">sentiment</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ticker</span> <span class="o">=</span> <span class="s1">&#39;AAPL&#39;</span>
<span class="n">timeframe</span> <span class="o">=</span> <span class="s1">&#39;1D&#39;</span>
<span class="n">current_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span> <span class="n">tz</span><span class="o">=</span><span class="s1">&#39;America/New_York&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
<span class="n">past_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">tz</span><span class="o">=</span><span class="s1">&#39;America/New_York&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">get_barset</span><span class="p">(</span>
    <span class="n">ticker</span><span class="p">,</span>
    <span class="n">timeframe</span><span class="p">,</span>
    <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start</span><span class="o">=</span><span class="n">past_date</span><span class="p">,</span>
    <span class="n">end</span><span class="o">=</span><span class="n">current_date</span><span class="p">,</span>
    <span class="n">after</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">until</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">df</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">HTTPError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">13</span><span class="o">-</span><span class="mi">9</span><span class="n">b49072d8b0e</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">current_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span> <span class="n">tz</span><span class="o">=</span><span class="s1">&#39;America/New_York&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">past_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">tz</span><span class="o">=</span><span class="s1">&#39;America/New_York&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="n">df</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">get_barset</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="n">ticker</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>     <span class="n">timeframe</span><span class="p">,</span>

<span class="nn">/opt/anaconda3/lib/python3.8/site-packages/alpaca_trade_api/rest.py</span> in <span class="ni">get_barset</span><span class="nt">(self, symbols, timeframe, limit, start, end, after, until)</span>
<span class="g g-Whitespace">    </span><span class="mi">485</span>         <span class="k">if</span> <span class="n">until</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">486</span>             <span class="n">params</span><span class="p">[</span><span class="s1">&#39;until&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">until</span>
<span class="ne">--&gt; </span><span class="mi">487</span>         <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_get</span><span class="p">(</span><span class="s1">&#39;/bars/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">timeframe</span><span class="p">),</span> <span class="n">params</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">488</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_wrapper</span><span class="p">(</span><span class="n">resp</span><span class="p">,</span> <span class="n">BarSet</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">489</span> 

<span class="nn">/opt/anaconda3/lib/python3.8/site-packages/alpaca_trade_api/rest.py</span> in <span class="ni">data_get</span><span class="nt">(self, path, data, api_version)</span>
<span class="g g-Whitespace">    </span><span class="mi">190</span>     <span class="k">def</span> <span class="nf">data_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">api_version</span><span class="o">=</span><span class="s1">&#39;v1&#39;</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">191</span>         <span class="n">base_url</span><span class="p">:</span> <span class="n">URL</span> <span class="o">=</span> <span class="n">get_data_url</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">192</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">193</span>             <span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">base_url</span><span class="o">=</span><span class="n">base_url</span><span class="p">,</span> <span class="n">api_version</span><span class="o">=</span><span class="n">api_version</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">194</span>         <span class="p">)</span>

<span class="nn">/opt/anaconda3/lib/python3.8/site-packages/alpaca_trade_api/rest.py</span> in <span class="ni">_request</span><span class="nt">(self, method, path, data, base_url, api_version)</span>
<span class="g g-Whitespace">    </span><span class="mi">137</span>         <span class="k">while</span> <span class="n">retry</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">138</span>             <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">139</span>                 <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_one_request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">opts</span><span class="p">,</span> <span class="n">retry</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">140</span>             <span class="k">except</span> <span class="n">RetryException</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">141</span>                 <span class="n">retry_wait</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_retry_wait</span>

<span class="nn">/opt/anaconda3/lib/python3.8/site-packages/alpaca_trade_api/rest.py</span> in <span class="ni">_one_request</span><span class="nt">(self, method, url, opts, retry)</span>
<span class="g g-Whitespace">    </span><span class="mi">158</span>         <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">159</span>         <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">160</span>             <span class="n">resp</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">161</span>         <span class="k">except</span> <span class="n">HTTPError</span> <span class="k">as</span> <span class="n">http_error</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">162</span>             <span class="c1"># retry if we hit Rate Limit</span>

<span class="nn">/opt/anaconda3/lib/python3.8/site-packages/requests/models.py</span> in <span class="ni">raise_for_status</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">941</span> 
<span class="g g-Whitespace">    </span><span class="mi">942</span>         <span class="k">if</span> <span class="n">http_error_msg</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">943</span>             <span class="k">raise</span> <span class="n">HTTPError</span><span class="p">(</span><span class="n">http_error_msg</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">944</span> 
<span class="g g-Whitespace">    </span><span class="mi">945</span>     <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="ne">HTTPError</span>: 403 Client Error: Forbidden for url: https://data.alpaca.markets/v1/bars/1D?symbols=AAPL&amp;start=2021-06-05T11%3A00%3A08.388578-04%3A00&amp;end=2021-07-05T11%3A00%3A08.350417-04%3A00
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">date</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>close</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-03-31</th>
      <td>122.1800</td>
    </tr>
    <tr>
      <th>2021-04-01</th>
      <td>123.0000</td>
    </tr>
    <tr>
      <th>2021-04-05</th>
      <td>125.9001</td>
    </tr>
    <tr>
      <th>2021-04-06</th>
      <td>126.2300</td>
    </tr>
    <tr>
      <th>2021-04-07</th>
      <td>127.9100</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aapl_returns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">aapl_returns</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>close</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-04-01</th>
      <td>0.006711</td>
    </tr>
    <tr>
      <th>2021-04-05</th>
      <td>0.023578</td>
    </tr>
    <tr>
      <th>2021-04-06</th>
      <td>0.002620</td>
    </tr>
    <tr>
      <th>2021-04-07</th>
      <td>0.013309</td>
    </tr>
    <tr>
      <th>2021-04-08</th>
      <td>0.019232</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aapl_headlines</span><span class="p">,</span> <span class="n">dates</span> <span class="o">=</span> <span class="n">get_headlines</span><span class="p">(</span><span class="s1">&#39;apple&#39;</span><span class="p">)</span>
<span class="n">trade_headlines</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_headlines</span><span class="p">(</span><span class="s1">&#39;trade&#39;</span><span class="p">)</span>
<span class="n">economy_headlines</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_headlines</span><span class="p">(</span><span class="s1">&#39;economy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fetching news about &#39;apple&#39;
******************************
retrieving news from: 2021-04-30 00:00:00
retrieving news from: 2021-04-29 00:00:00
retrieving news from: 2021-04-28 00:00:00
retrieving news from: 2021-04-27 00:00:00
retrieving news from: 2021-04-26 00:00:00
retrieving news from: 2021-04-25 00:00:00
retrieving news from: 2021-04-24 00:00:00
retrieving news from: 2021-04-23 00:00:00
retrieving news from: 2021-04-22 00:00:00
retrieving news from: 2021-04-21 00:00:00
retrieving news from: 2021-04-20 00:00:00
retrieving news from: 2021-04-19 00:00:00
retrieving news from: 2021-04-18 00:00:00
retrieving news from: 2021-04-17 00:00:00
retrieving news from: 2021-04-16 00:00:00
retrieving news from: 2021-04-15 00:00:00
retrieving news from: 2021-04-14 00:00:00
retrieving news from: 2021-04-13 00:00:00
retrieving news from: 2021-04-12 00:00:00
retrieving news from: 2021-04-11 00:00:00
retrieving news from: 2021-04-10 00:00:00
retrieving news from: 2021-04-09 00:00:00
retrieving news from: 2021-04-08 00:00:00
retrieving news from: 2021-04-07 00:00:00
retrieving news from: 2021-04-06 00:00:00
retrieving news from: 2021-04-05 00:00:00
retrieving news from: 2021-04-04 00:00:00
retrieving news from: 2021-04-03 00:00:00
retrieving news from: 2021-04-02 00:00:00
retrieving news from: 2021-04-01 00:00:00
Fetching news about &#39;trade&#39;
******************************
retrieving news from: 2021-04-30 00:00:00
retrieving news from: 2021-04-29 00:00:00
retrieving news from: 2021-04-28 00:00:00
retrieving news from: 2021-04-27 00:00:00
retrieving news from: 2021-04-26 00:00:00
retrieving news from: 2021-04-25 00:00:00
retrieving news from: 2021-04-24 00:00:00
retrieving news from: 2021-04-23 00:00:00
retrieving news from: 2021-04-22 00:00:00
retrieving news from: 2021-04-21 00:00:00
retrieving news from: 2021-04-20 00:00:00
retrieving news from: 2021-04-19 00:00:00
retrieving news from: 2021-04-18 00:00:00
retrieving news from: 2021-04-17 00:00:00
retrieving news from: 2021-04-16 00:00:00
retrieving news from: 2021-04-15 00:00:00
retrieving news from: 2021-04-14 00:00:00
retrieving news from: 2021-04-13 00:00:00
retrieving news from: 2021-04-12 00:00:00
retrieving news from: 2021-04-11 00:00:00
retrieving news from: 2021-04-10 00:00:00
retrieving news from: 2021-04-09 00:00:00
retrieving news from: 2021-04-08 00:00:00
retrieving news from: 2021-04-07 00:00:00
retrieving news from: 2021-04-06 00:00:00
retrieving news from: 2021-04-05 00:00:00
retrieving news from: 2021-04-04 00:00:00
retrieving news from: 2021-04-03 00:00:00
retrieving news from: 2021-04-02 00:00:00
retrieving news from: 2021-04-01 00:00:00
Fetching news about &#39;economy&#39;
******************************
retrieving news from: 2021-04-30 00:00:00
retrieving news from: 2021-04-29 00:00:00
retrieving news from: 2021-04-28 00:00:00
retrieving news from: 2021-04-27 00:00:00
retrieving news from: 2021-04-26 00:00:00
retrieving news from: 2021-04-25 00:00:00
retrieving news from: 2021-04-24 00:00:00
retrieving news from: 2021-04-23 00:00:00
retrieving news from: 2021-04-22 00:00:00
retrieving news from: 2021-04-21 00:00:00
retrieving news from: 2021-04-20 00:00:00
retrieving news from: 2021-04-19 00:00:00
retrieving news from: 2021-04-18 00:00:00
retrieving news from: 2021-04-17 00:00:00
retrieving news from: 2021-04-16 00:00:00
retrieving news from: 2021-04-15 00:00:00
retrieving news from: 2021-04-14 00:00:00
retrieving news from: 2021-04-13 00:00:00
retrieving news from: 2021-04-12 00:00:00
retrieving news from: 2021-04-11 00:00:00
retrieving news from: 2021-04-10 00:00:00
retrieving news from: 2021-04-09 00:00:00
retrieving news from: 2021-04-08 00:00:00
retrieving news from: 2021-04-07 00:00:00
retrieving news from: 2021-04-06 00:00:00
retrieving news from: 2021-04-05 00:00:00
retrieving news from: 2021-04-04 00:00:00
retrieving news from: 2021-04-03 00:00:00
retrieving news from: 2021-04-02 00:00:00
retrieving news from: 2021-04-01 00:00:00
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sid</span> <span class="o">=</span> <span class="n">SentimentIntensityAnalyzer</span><span class="p">()</span>

<span class="n">aapl_avg</span> <span class="o">=</span> <span class="n">headline_sentiment_summarizer_avg</span><span class="p">(</span><span class="n">aapl_headlines</span><span class="p">)</span>
<span class="n">trade_avg</span> <span class="o">=</span> <span class="n">headline_sentiment_summarizer_avg</span><span class="p">(</span><span class="n">trade_headlines</span><span class="p">)</span>
<span class="n">economy_avg</span> <span class="o">=</span> <span class="n">headline_sentiment_summarizer_avg</span><span class="p">(</span><span class="n">economy_headlines</span><span class="p">)</span>

<span class="n">topic_sentiments</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;aapl_avg&#39;</span><span class="p">:</span> <span class="n">aapl_avg</span><span class="p">,</span> <span class="s1">&#39;trade_avg&#39;</span><span class="p">:</span> <span class="n">trade_avg</span><span class="p">,</span> <span class="s1">&#39;economy_avg&#39;</span><span class="p">:</span> <span class="n">economy_avg</span><span class="p">})</span>
<span class="n">topic_sentiments</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>
<span class="n">topic_sentiments</span> <span class="o">=</span> <span class="n">aapl_returns</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">topic_sentiments</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">)</span>
<span class="n">topic_sentiments</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>close</th>
      <th>aapl_avg</th>
      <th>trade_avg</th>
      <th>economy_avg</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-04-01</th>
      <td>0.006711</td>
      <td>0.031140</td>
      <td>0.012465</td>
      <td>0.151895</td>
    </tr>
    <tr>
      <th>2021-04-05</th>
      <td>0.023578</td>
      <td>0.066610</td>
      <td>0.171115</td>
      <td>0.094840</td>
    </tr>
    <tr>
      <th>2021-04-06</th>
      <td>0.002620</td>
      <td>0.262250</td>
      <td>0.083030</td>
      <td>0.109210</td>
    </tr>
    <tr>
      <th>2021-04-07</th>
      <td>0.013309</td>
      <td>-0.002540</td>
      <td>0.012705</td>
      <td>0.130105</td>
    </tr>
    <tr>
      <th>2021-04-08</th>
      <td>0.019232</td>
      <td>0.000585</td>
      <td>-0.068855</td>
      <td>0.114510</td>
    </tr>
    <tr>
      <th>2021-04-09</th>
      <td>0.020173</td>
      <td>-0.025520</td>
      <td>-0.052630</td>
      <td>-0.013170</td>
    </tr>
    <tr>
      <th>2021-04-12</th>
      <td>-0.013083</td>
      <td>0.028335</td>
      <td>0.052780</td>
      <td>0.131135</td>
    </tr>
    <tr>
      <th>2021-04-13</th>
      <td>0.023998</td>
      <td>0.058765</td>
      <td>0.057265</td>
      <td>0.033165</td>
    </tr>
    <tr>
      <th>2021-04-14</th>
      <td>-0.017037</td>
      <td>-0.050860</td>
      <td>0.019220</td>
      <td>0.133885</td>
    </tr>
    <tr>
      <th>2021-04-15</th>
      <td>0.018014</td>
      <td>0.133615</td>
      <td>-0.119125</td>
      <td>0.082985</td>
    </tr>
    <tr>
      <th>2021-04-16</th>
      <td>-0.002602</td>
      <td>0.186835</td>
      <td>-0.118765</td>
      <td>-0.006515</td>
    </tr>
    <tr>
      <th>2021-04-19</th>
      <td>0.005747</td>
      <td>-0.000670</td>
      <td>0.084685</td>
      <td>-0.023520</td>
    </tr>
    <tr>
      <th>2021-04-20</th>
      <td>-0.013349</td>
      <td>0.117820</td>
      <td>0.033640</td>
      <td>0.114600</td>
    </tr>
    <tr>
      <th>2021-04-21</th>
      <td>0.002779</td>
      <td>-0.001075</td>
      <td>-0.016025</td>
      <td>0.106345</td>
    </tr>
    <tr>
      <th>2021-04-22</th>
      <td>-0.011611</td>
      <td>0.111985</td>
      <td>0.082405</td>
      <td>-0.046230</td>
    </tr>
    <tr>
      <th>2021-04-23</th>
      <td>0.017887</td>
      <td>0.100505</td>
      <td>0.004105</td>
      <td>0.115625</td>
    </tr>
    <tr>
      <th>2021-04-26</th>
      <td>0.003202</td>
      <td>0.004535</td>
      <td>-0.121555</td>
      <td>0.066170</td>
    </tr>
    <tr>
      <th>2021-04-27</th>
      <td>-0.002524</td>
      <td>0.044580</td>
      <td>-0.049025</td>
      <td>0.108730</td>
    </tr>
    <tr>
      <th>2021-04-28</th>
      <td>-0.004538</td>
      <td>-0.044945</td>
      <td>0.076720</td>
      <td>0.035295</td>
    </tr>
    <tr>
      <th>2021-04-29</th>
      <td>-0.002243</td>
      <td>0.105400</td>
      <td>0.085600</td>
      <td>0.016205</td>
    </tr>
    <tr>
      <th>2021-04-30</th>
      <td>-0.014609</td>
      <td>-0.025845</td>
      <td>0.086395</td>
      <td>0.020590</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">topic_sentiments</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
#T_97063_row0_col0,#T_97063_row1_col1,#T_97063_row2_col2,#T_97063_row3_col3{
            background-color:  #023858;
            color:  #f1f1f1;
        }#T_97063_row0_col1{
            background-color:  #f2ecf5;
            color:  #000000;
        }#T_97063_row0_col2,#T_97063_row2_col0,#T_97063_row2_col3,#T_97063_row3_col1{
            background-color:  #fff7fb;
            color:  #000000;
        }#T_97063_row0_col3{
            background-color:  #eae6f1;
            color:  #000000;
        }#T_97063_row1_col0{
            background-color:  #e0deed;
            color:  #000000;
        }#T_97063_row1_col2{
            background-color:  #ece7f2;
            color:  #000000;
        }#T_97063_row1_col3{
            background-color:  #f8f1f8;
            color:  #000000;
        }#T_97063_row2_col1{
            background-color:  #fbf3f9;
            color:  #000000;
        }#T_97063_row3_col0{
            background-color:  #dfddec;
            color:  #000000;
        }#T_97063_row3_col2{
            background-color:  #f6eff7;
            color:  #000000;
        }</style><table id="T_97063_" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >close</th>        <th class="col_heading level0 col1" >aapl_avg</th>        <th class="col_heading level0 col2" >trade_avg</th>        <th class="col_heading level0 col3" >economy_avg</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_97063_level0_row0" class="row_heading level0 row0" >close</th>
                        <td id="T_97063_row0_col0" class="data row0 col0" >1.000000</td>
                        <td id="T_97063_row0_col1" class="data row0 col1" >0.044293</td>
                        <td id="T_97063_row0_col2" class="data row0 col2" >-0.161919</td>
                        <td id="T_97063_row0_col3" class="data row0 col3" >0.054640</td>
            </tr>
            <tr>
                        <th id="T_97063_level0_row1" class="row_heading level0 row1" >aapl_avg</th>
                        <td id="T_97063_row1_col0" class="data row1 col0" >0.044293</td>
                        <td id="T_97063_row1_col1" class="data row1 col1" >1.000000</td>
                        <td id="T_97063_row1_col2" class="data row1 col2" >-0.014097</td>
                        <td id="T_97063_row1_col3" class="data row1 col3" >-0.044969</td>
            </tr>
            <tr>
                        <th id="T_97063_level0_row2" class="row_heading level0 row2" >trade_avg</th>
                        <td id="T_97063_row2_col0" class="data row2 col0" >-0.161919</td>
                        <td id="T_97063_row2_col1" class="data row2 col1" >-0.014097</td>
                        <td id="T_97063_row2_col2" class="data row2 col2" >1.000000</td>
                        <td id="T_97063_row2_col3" class="data row2 col3" >-0.093465</td>
            </tr>
            <tr>
                        <th id="T_97063_level0_row3" class="row_heading level0 row3" >economy_avg</th>
                        <td id="T_97063_row3_col0" class="data row3 col0" >0.054640</td>
                        <td id="T_97063_row3_col1" class="data row3 col1" >-0.044969</td>
                        <td id="T_97063_row3_col2" class="data row3 col2" >-0.093465</td>
                        <td id="T_97063_row3_col3" class="data row3 col3" >1.000000</td>
            </tr>
    </tbody></table></div></div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">article</span> <span class="o">=</span> <span class="n">reuters</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="n">fileids</span> <span class="o">=</span> <span class="n">reuters</span><span class="o">.</span><span class="n">fileids</span><span class="p">(</span><span class="n">categories</span><span class="o">=</span><span class="s1">&#39;gas&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">article</span><span class="p">)</span>
<span class="n">displacy</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ent&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span class="tex2jax_ignore"><div class="entities" style="line-height: 2.5; direction: ltr">FINNS AND CANADIANS TO STUDY MTBE PRODUCTION PLANT</br>  
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Finland
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
's national oil company 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Neste Oy
  &amp;lt;NEOY.HE&gt;
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
 said in a statement it had agreed with 
<mark class="entity" style="background: #c887fb; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Canadian
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">NORP</span>
</mark>
 firms</br>  to study the feasibility of building a plant in 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Edmonton
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
,</br>  Canada, to produce a replacement for lead in petrol.</br>      The prospective plant would cost 
<mark class="entity" style="background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    an estimated 270
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">CARDINAL</span>
</mark>
 mln</br>  Canadian dlrs and would produce methyl tertiary butyl ether</br>  (
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    MTBE
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
) from raw materials available locally, it said.</br>      The partners in the study are 
<mark class="entity" style="background: #aa9cfc; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Neste Oy
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PERSON</span>
</mark>
, 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Celanese Canada
  Inc
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
, 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Hoechst Celanese Corporation
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
 and Trade Mountain Pipe Line</br>  Company Ltd, of 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Vancouver
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
, 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    B.C.
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
</br>      The 
<mark class="entity" style="background: #aa9cfc; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Edmonton
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PERSON</span>
</mark>
 site was suitable because of the raw materials</br>  availability, the proximity to pipeline transportation and the</br>  important capital and operating advantages gained by locating</br>  on an existing 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Celanese Canada
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
 site, the statement said.</br>      The partners would look into the feasibility of a plant</br>  producing 
<mark class="entity" style="background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    500,000 tonnes
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">QUANTITY</span>
</mark>
 per annum of 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    MTBE
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
, an octane enhancer</br>  that can replace tetra ethyl lead.</br>      Most of the 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    MTBE
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
 would be targeted for 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    the United States
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
</br>  where lead levels in gasoline are being lowered because of</br>  health concerns, the statement added.</br>      
<mark class="entity" style="background: #c887fb; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Canadian
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">NORP</span>
</mark>
 lead limits are currently 
<mark class="entity" style="background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    11
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">CARDINAL</span>
</mark>
 times as high as the</br>  U.S. Limit but lead is scheduled for virtual elimination in</br>  
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Canada
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
 by 
<mark class="entity" style="background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    1993
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">DATE</span>
</mark>
, which should create a 
<mark class="entity" style="background: #c887fb; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Canadian
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">NORP</span>
</mark>
 demand for 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    MTBE
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
,</br>  it said.</br>      
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Finland
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
's 
<mark class="entity" style="background: #aa9cfc; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Neste Oy
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PERSON</span>
</mark>
, whose turnover 
<mark class="entity" style="background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    last year
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">DATE</span>
</mark>
 was over 
<mark class="entity" style="background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    five
  billion
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">MONEY</span>
</mark>
 dlrs, has extensive experience with MTBE. It has a</br>  major investment in an 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    MTBE
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
 plant in 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Saudi Arabia
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
.</br>      The 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Edmonton
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
, 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Alberta
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
 plant would be scheduled to go on</br>  stream in 
<mark class="entity" style="background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    late 1989
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">DATE</span>
</mark>
, the statement said.</br>  </br></br></div></span></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">articles</span> <span class="o">=</span> <span class="n">reuters</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="n">categories</span><span class="o">=</span><span class="s1">&#39;gas&#39;</span><span class="p">)</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">articles</span><span class="p">)</span>
<span class="n">entities</span> <span class="o">=</span> <span class="p">[</span><span class="n">ent</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span> <span class="k">if</span> <span class="n">ent</span><span class="o">.</span><span class="n">label_</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;GPE&#39;</span><span class="p">,</span> <span class="s1">&#39;ORG&#39;</span><span class="p">]]</span>
<span class="n">entities</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">entities</span><span class="p">]</span>
<span class="n">wc</span> <span class="o">=</span> <span class="n">WordCloud</span><span class="p">()</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">entities</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">wc</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/nlp_31_0.png" src="../_images/nlp_31_0.png" />
</div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;Michael Jordan was a player in the National Basketball Association.&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:40}{:40}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">ent</span><span class="o">.</span><span class="n">label_</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Michael Jordan                          PERSON                                  
the National Basketball Association     ORG                                     
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">article</span> <span class="o">=</span> <span class="n">reuters</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="n">fileids</span> <span class="o">=</span> <span class="n">reuters</span><span class="o">.</span><span class="n">fileids</span><span class="p">(</span><span class="n">categories</span><span class="o">=</span><span class="s1">&#39;yen&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">article</span><span class="p">)</span>
<span class="nb">print</span><span class="p">([</span><span class="n">ent</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span> <span class="k">if</span> <span class="n">ent</span><span class="o">.</span><span class="n">label_</span> <span class="o">==</span> <span class="s1">&#39;GPE&#39;</span><span class="p">])</span>
<span class="n">displacy</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ent&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;JAPAN&#39;, &#39;Japan&#39;, &#39;Washington&#39;, &#39;Japan&#39;, &#39;Paris&#39;, &#39;Britain&#39;, &#39;Canada&#39;, &#39;France&#39;, &#39;Italy&#39;, &#39;Japan&#39;, &#39;U.S.&#39;, &#39;West Germany&#39;]
</pre></div>
</div>
<div class="output text_html"><span class="tex2jax_ignore"><div class="entities" style="line-height: 2.5; direction: ltr">
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    JAPAN
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
 BUSINESS LEADERS SAY G-7 ACCORD IS WORRYING</br>  The leaders of 
<mark class="entity" style="background: #e4e7d2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    two
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">CARDINAL</span>
</mark>
 of 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Japan
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
's top business</br>  groups said in separate statements 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    the Group of Seven
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
 (
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    G-7
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
)</br>  accord reached in 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Washington
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>

<mark class="entity" style="background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    yesterday
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">DATE</span>
</mark>
 is of deep concern to</br>  
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Japan
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
 because it shows the major industrial nations regard the</br>  yen's current level as appropriate.</br>      
<mark class="entity" style="background: #aa9cfc; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Eishiro Saito
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PERSON</span>
</mark>
, chairman of 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    the Federation of Economic
  Organizations
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
 (Keidanren), said the yen's present rate is well</br>  above adequate levels. He did not elaborate.</br>      
<mark class="entity" style="background: #aa9cfc; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Takashi Ishihara
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PERSON</span>
</mark>
, chairman of 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    the Japan Committee for
  Economic Development
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
, said the accord will not prevent the yen</br>  from rising further.</br>      &quot;We do not understand why the 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    G-7
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
 approved present rates as</br>  the yen has risen excessively since the 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Paris
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
 accord,&quot; 
<mark class="entity" style="background: #bfeeb7; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Ishihara

    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PRODUCT</span>
</mark>
said.</br>      
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    G-7
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
 members 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Britain
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
, 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Canada
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
, 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    France
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
, 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Italy
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
, 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Japan
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
, the 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    U.S.
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
</br>  And 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    West Germany
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
 said in a statement they consider their</br>  currencies are now within ranges broadly consistent with</br>  economic fundamentals.</br>      
<mark class="entity" style="background: #aa9cfc; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Saito
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PERSON</span>
</mark>
 called on each 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    G-7
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
 member nation to prepare to</br>  intervene in the market strongly enough to ensure exchange</br>  rates are stabilised at appropriate levels.</br>  </br></br></div></span></div></div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">most_freq_adj</span> <span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; This function uses spaCy to get the most common adjectives from each text.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">      text (string): The text to analyze</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">      most_common_adj (list): A list containing a tuple with the most common adjective and its occurrence in the text</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Tokenizes text and parses each token</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    
    <span class="c1"># Creates a list with all the adjectives in the text</span>
    <span class="n">adjs</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">pos_</span> <span class="o">==</span> <span class="s1">&#39;ADJ&#39;</span><span class="p">]</span>
    
    <span class="c1"># Retrieves the most frequent adjective in the `adjs` list using the Counter module</span>
    <span class="n">most_common_adj</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">adjs</span><span class="p">)</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">most_common_adj</span>

<span class="k">def</span> <span class="nf">all_adj</span> <span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; This function retrieves all the adjectives on the given text.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">      text (string): The text to analyze.</span>
<span class="sd">      </span>
<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">      adjs (string): A list with all the adjectives in the text</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Tokenize the text and parse each token</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    
    <span class="c1"># Create a list with all the adjectives in the text</span>
    <span class="n">adjs</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">pos_</span> <span class="o">==</span> <span class="s1">&#39;ADJ&#39;</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">adjs</span>

<span class="k">def</span> <span class="nf">get_word_counts</span> <span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; This function counts the occurrences of a word in a text.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">      text (string): The text where word counts will be analyzed</span>
<span class="sd">      word (string): The word to look into the text</span>
<span class="sd">      </span>
<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">      word_count (int): The counts of the word in the given text</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Use the word_tokenize module from NLTK to tokenize the text</span>
    <span class="n">tok</span> <span class="o">=</span> <span class="n">word_tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    
    <span class="c1"># Create a list with all the tokens retrieved from the text</span>
    <span class="n">tok</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">tok</span><span class="p">]</span>
    
    <span class="c1"># Count the occurrences of the word in the text</span>
    <span class="n">word_count</span> <span class="o">=</span> <span class="n">tok</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">word_count</span>

<span class="k">def</span> <span class="nf">describe_america</span> <span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; This function retrieves the adjectives in the text that describe the word &#39;America&#39;.</span>
<span class="sd">    Parameters</span>
<span class="sd">      text (string): The text to analyze.</span>
<span class="sd">    Returns</span>
<span class="sd">      adjs (list): A list of the adjectives that describe the word &#39;America&#39; in the text.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Use the spaCy English language model to tokenize the text and parse each token</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    
    <span class="c1"># Create a list with all the adjectives in the text that describe the word &#39;America&#39;</span>
    <span class="n">adjs</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span> <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">pos_</span> <span class="o">==</span> <span class="s1">&#39;ADJ&#39;</span> <span class="ow">and</span> <span class="n">token</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">text</span> <span class="o">==</span> <span class="s1">&#39;America&#39;</span><span class="p">)]</span>
    
    <span class="k">return</span> <span class="n">adjs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ids</span> <span class="o">=</span> <span class="n">inaugural</span><span class="o">.</span><span class="n">fileids</span><span class="p">()</span>
<span class="n">texts</span> <span class="o">=</span> <span class="p">[</span><span class="n">inaugural</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">]</span>
<span class="n">adjs</span> <span class="o">=</span> <span class="p">[</span><span class="n">most_freq_adj</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">]</span>
<span class="n">df_adjs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;doc_id&#39;</span><span class="p">:</span> <span class="n">ids</span><span class="p">,</span> <span class="s1">&#39;adjective&#39;</span><span class="p">:</span> <span class="n">adjs</span><span class="p">})</span>
<span class="n">df_adjs</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>doc_id</th>
      <th>adjective</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1789-Washington.txt</td>
      <td>[(public, 6)]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1793-Washington.txt</td>
      <td>[(fellow, 1)]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1797-Adams.txt</td>
      <td>[(foreign, 8)]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1801-Jefferson.txt</td>
      <td>[(own, 6)]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1805-Jefferson.txt</td>
      <td>[(public, 14)]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_adjectives</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">:</span>
    <span class="n">all_adjectives</span> <span class="o">=</span> <span class="n">all_adjectives</span> <span class="o">+</span> <span class="n">all_adj</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="n">most_freq_adjectives</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">all_adjectives</span><span class="p">)</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">great_counts</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_word_counts</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;great&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">]</span>
<span class="n">other_counts</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_word_counts</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">]</span>
<span class="n">own_counts</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_word_counts</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">]</span>
<span class="n">dates</span> <span class="o">=</span> <span class="p">[</span><span class="nb">id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">]</span>
<span class="n">presidents</span> <span class="o">=</span> <span class="p">[</span><span class="nb">id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">]</span>
<span class="n">adjectives_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;president&#39;</span><span class="p">:</span> <span class="n">presidents</span><span class="p">,</span> <span class="s1">&#39;great&#39;</span><span class="p">:</span> <span class="n">great_counts</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">:</span> <span class="n">other_counts</span><span class="p">,</span> <span class="s1">&#39;own&#39;</span><span class="p">:</span> <span class="n">own_counts</span><span class="p">}</span>
<span class="n">df_adjectives</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">adjectives_data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
<span class="n">df_adjectives</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>president</th>
      <th>great</th>
      <th>other</th>
      <th>own</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1789</th>
      <td>Washington</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1793</th>
      <td>Washington</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1797</th>
      <td>Adams</td>
      <td>5</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1801</th>
      <td>Jefferson</td>
      <td>1</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1805</th>
      <td>Jefferson</td>
      <td>1</td>
      <td>6</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_adjectives</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Most Common Adjectives Used in the U.S. Presidential Inaugural Addresses&#39;</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/nlp_39_0.png" src="../_images/nlp_39_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">america_adjectives</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">:</span>
    <span class="n">america_adjectives</span> <span class="o">=</span> <span class="n">america_adjectives</span> <span class="o">+</span> <span class="n">describe_america</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="n">america_adjectives</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;united&#39;, &#39;productive&#39;, &#39;alert&#39;, &#39;strong&#39;, &#39;stronger&#39;, &#39;rich&#39;]
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">parser</span> <span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
        <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}{:20}{:20}{:20}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">pos_</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">dep_</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">text</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">l</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s1</span> <span class="o">=</span> <span class="s1">&#39;The brown cow jumped over the round moon.&#39;</span>
<span class="n">s2</span> <span class="o">=</span> <span class="s1">&#39;Jose made a book collector happy the other day.&#39;</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">parser</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jose                PROPN               nsubj               made                
made                VERB                ROOT                made                
a                   DET                 det                 collector           
book                NOUN                compound            collector           
collector           NOUN                nsubj               happy               
happy               ADJ                 ccomp               made                
the                 DET                 det                 day                 
other               ADJ                 amod                day                 
day                 NOUN                npadvmod            happy               
.                   PUNCT               punct               made                
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nouns</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">pos_</span> <span class="o">==</span> <span class="s1">&#39;NOUN&#39;</span><span class="p">]</span>
<span class="n">cow_describers</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span> <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">text</span> <span class="o">==</span> <span class="s1">&#39;cow&#39;</span> <span class="ow">and</span> <span class="n">token</span><span class="o">.</span><span class="n">pos_</span> <span class="o">==</span> <span class="s1">&#39;ADJ&#39;</span><span class="p">)]</span>
<span class="n">display</span><span class="p">(</span>
    <span class="n">nouns</span><span class="p">,</span>
    <span class="n">cow_describers</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;cow&#39;, &#39;moon&#39;]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;brown&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">displacy</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;dep&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span class="tex2jax_ignore"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:lang="en" id="71a1ce5b4cff43ddb239cf9a6c4a526a-0" class="displacy" width="1450" height="399.5" direction="ltr" style="max-width: none; height: 399.5px; color: #000000; background: #ffffff; font-family: Arial; direction: ltr">
<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="50">The</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="50">DET</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="225">brown</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="225">ADJ</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="400">cow</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="400">NOUN</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="575">jumped</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="575">VERB</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="750">over</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="750">ADP</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="925">the</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="925">DET</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="1100">round</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1100">ADJ</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="1275">moon.</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1275">NOUN</tspan>
</text>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-71a1ce5b4cff43ddb239cf9a6c4a526a-0-0" stroke-width="2px" d="M70,264.5 C70,89.5 395.0,89.5 395.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-71a1ce5b4cff43ddb239cf9a6c4a526a-0-0" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">det</textPath>
    </text>
    <path class="displacy-arrowhead" d="M70,266.5 L62,254.5 78,254.5" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-71a1ce5b4cff43ddb239cf9a6c4a526a-0-1" stroke-width="2px" d="M245,264.5 C245,177.0 390.0,177.0 390.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-71a1ce5b4cff43ddb239cf9a6c4a526a-0-1" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">amod</textPath>
    </text>
    <path class="displacy-arrowhead" d="M245,266.5 L237,254.5 253,254.5" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-71a1ce5b4cff43ddb239cf9a6c4a526a-0-2" stroke-width="2px" d="M420,264.5 C420,177.0 565.0,177.0 565.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-71a1ce5b4cff43ddb239cf9a6c4a526a-0-2" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">nsubj</textPath>
    </text>
    <path class="displacy-arrowhead" d="M420,266.5 L412,254.5 428,254.5" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-71a1ce5b4cff43ddb239cf9a6c4a526a-0-3" stroke-width="2px" d="M595,264.5 C595,177.0 740.0,177.0 740.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-71a1ce5b4cff43ddb239cf9a6c4a526a-0-3" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">prep</textPath>
    </text>
    <path class="displacy-arrowhead" d="M740.0,266.5 L748.0,254.5 732.0,254.5" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-71a1ce5b4cff43ddb239cf9a6c4a526a-0-4" stroke-width="2px" d="M945,264.5 C945,89.5 1270.0,89.5 1270.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-71a1ce5b4cff43ddb239cf9a6c4a526a-0-4" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">det</textPath>
    </text>
    <path class="displacy-arrowhead" d="M945,266.5 L937,254.5 953,254.5" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-71a1ce5b4cff43ddb239cf9a6c4a526a-0-5" stroke-width="2px" d="M1120,264.5 C1120,177.0 1265.0,177.0 1265.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-71a1ce5b4cff43ddb239cf9a6c4a526a-0-5" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">amod</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1120,266.5 L1112,254.5 1128,254.5" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-71a1ce5b4cff43ddb239cf9a6c4a526a-0-6" stroke-width="2px" d="M770,264.5 C770,2.0 1275.0,2.0 1275.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-71a1ce5b4cff43ddb239cf9a6c4a526a-0-6" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">pobj</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1275.0,266.5 L1283.0,254.5 1267.0,254.5" fill="currentColor"/>
</g>
</svg></span></div></div>
</div>
<hr class="docutils" />

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./nbs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Dave Friedman<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>